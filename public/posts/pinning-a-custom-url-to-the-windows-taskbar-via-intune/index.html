<!doctype html><html lang=en><head><title>Pinning a Custom URL to the Windows Taskbar via Intune :: HalfOnCloud</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A step-by-step Intune deployment of a custom URL shortcut to the Windows Taskbar, unpacking the SYSTEM context limitation, the Win32 app and XML Layout policy dependency chain and the silent failure that occurs when the shortcut isn't on disk before the policy fires."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://halfoncloud.com/posts/pinning-a-custom-url-to-the-windows-taskbar-via-intune/><link rel=stylesheet href=https://halfoncloud.com/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://halfoncloud.com/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://halfoncloud.com/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://halfoncloud.com/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://halfoncloud.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://halfoncloud.com/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://halfoncloud.com/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://halfoncloud.com/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://halfoncloud.com/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://halfoncloud.com/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://halfoncloud.com/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://halfoncloud.com/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://halfoncloud.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://halfoncloud.com/style.css><link rel="shortcut icon" href=https://halfoncloud.com/favicon.png><link rel=apple-touch-icon href=https://halfoncloud.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Pinning a Custom URL to the Windows Taskbar via Intune"><meta property="og:description" content="A step-by-step Intune deployment of a custom URL shortcut to the Windows Taskbar, unpacking the SYSTEM context limitation, the Win32 app and XML Layout policy dependency chain and the silent failure that occurs when the shortcut isn't on disk before the policy fires."><meta property="og:url" content="https://halfoncloud.com/posts/pinning-a-custom-url-to-the-windows-taskbar-via-intune/"><meta property="og:site_name" content="HalfOnCloud"><meta property="og:image" content="https://halfoncloud.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Cloud"><meta property="article:published_time" content="2026-02-21 00:00:00 +0000 UTC"><script async src="https://www.googletagmanager.com/gtag/js?id=G-9NQJGGWW9C"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9NQJGGWW9C")</script><link rel=alternate type=application/rss+xml title=HalfOnCloud href=/index.xml><script type=application/ld+json>{"@context":"https://schema.org","@type":"TechArticle","headline":"Pinning a Custom URL to the Windows Taskbar via Intune","description":"A step-by-step Intune deployment of a custom URL shortcut to the Windows Taskbar, unpacking the SYSTEM context limitation, the Win32 app and XML Layout policy dependency chain and the silent failure that occurs when the shortcut isn't on disk before the policy fires.","author":{"@type":"Person","name":"Radu Bogdan"},"datePublished":"2026-02-21","dateModified":"2026-02-21","url":"https://halfoncloud.com/posts/pinning-a-custom-url-to-the-windows-taskbar-via-intune/","publisher":{"@type":"Organization","name":"HalfOnCloud"},"keywords":["MSIntune","Win32Apps","#LayoutXML"],"wordCount":2375,"timeRequired":"PT12M"}</script><style>body{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif!important;font-size:1.05rem!important}h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif!important;font-weight:700!important}article h1,article h2,article h3,article.post h1,article.post h2,article.post h3,.content h1,.content h2,.content h3{color:#4a9eff!important;border-bottom:none!important}article.post .post-title{color:#4a9eff!important;border-bottom:none!important}article.post .post-title a{color:#4a9eff!important}.logo{background:0 0!important;padding-left:0!important;margin-left:0!important}.header__logo::after{margin-left:10px;background:repeating-linear-gradient(90deg,#4a9eff,#4a9eff 2px,transparent 0,transparent 10px)!important}img{border:none!important}article a,.post-content a{color:#4a9eff!important}article a:hover,.post-content a:hover{color:#6bb3ff!important}body,html{background-color:#1a1d2e!important}.header{margin-bottom:30px!important}.post.on-list{background:#363636;padding:20px;margin-bottom:20px;border-radius:8px}.post-title a{font-size:1.4rem!important;color:#4a9eff!important}.post-title{border-bottom:none!important;padding-bottom:0!important}.post-title::after,h1::after,h2::after,h3::after{display:none!important}.post-tags{color:#4a9eff!important}.post-tags a{color:#4a9eff!important}.post-tags a:hover{color:#6bb0ff!important}.navigation-menu a{color:#4a9eff!important}.navigation-menu a:hover{color:#6bb0ff!important}.menu__trigger{color:#4a9eff!important;border:2px solid #4a9eff!important;background-color:transparent!important}.menu__dropdown{background-color:#363636!important;border:2px solid #4a9eff!important}.menu__dropdown a{color:#4a9eff!important}.menu__dropdown a:hover{color:#6bb0ff!important;background-color:#404040!important}.read-more.button{display:inline-block!important;background-color:#4a9eff!important;color:#fff!important;padding:8px 18px!important;border-radius:28px!important;text-decoration:none!important;font-weight:600!important;transition:all .3s ease!important;border:none!important;font-size:0!important}.read-more.button::after{content:"Read More →"!important;font-size:.99rem!important;display:inline-block}.read-more.button:hover{background-color:#6bb0ff!important;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.2)}article ul,.post-content ul{list-style:none!important}article ul li,.post-content ul li{position:relative!important;padding-left:1.2em!important}article ul li::before,.post-content ul li::before{content:"●"!important;position:absolute!important;left:0!important;color:#4a9eff!important;font-weight:700!important}article ul ul li::before,.post-content ul ul li::before{content:"○"!important;color:#4a9eff!important}.sidebar-left ul li::before,.sidebar-right ul li::before,.sidebar-nav ul li::before,.widget-list li::before{content:none!important;display:none!important}.sidebar-left ul li,.sidebar-right ul li,.sidebar-nav ul li,.widget-list li{padding-left:0!important}.heading-link,.anchor,.zola-anchor,h1 a.anchor,h2 a.anchor,h3 a.anchor,h1>a[href^="#"],h2>a[href^="#"],h3>a[href^="#"]{display:none!important;visibility:hidden!important}.sidebar-nav a{font-weight:700!important}.sidebar-title{font-size:1.8rem!important}body.three-column-layout{display:flex;min-height:100vh;margin:0;padding:0}.sidebar-left{width:250px;min-width:250px;background-color:#13151f;border-right:1px solid #2a2d3e;position:fixed;left:0;top:0;height:100vh;overflow-y:auto;z-index:100}.sidebar-left__inner{padding:30px 20px;display:flex;flex-direction:column;align-items:center}.sidebar-avatar{margin-bottom:15px}.avatar-img{width:120px;height:120px;border-radius:50%;object-fit:cover;border:3px solid #4a9eff}.avatar-placeholder{width:120px;height:120px;border-radius:50%;background:linear-gradient(135deg,#4a9eff 0%,#6bb0ff 100%);display:flex;align-items:center;justify-content:center;font-size:3rem;font-weight:700;color:#fff}.sidebar-title{font-size:1.5rem;margin:10px 0 5px;text-align:center}.sidebar-title a{color:#fff;text-decoration:none}.sidebar-title .red{color:#f44}.sidebar-tagline{font-size:.85rem;color:#888;text-align:center;margin:0 0 25px;line-height:1.4}.sidebar-nav ul{list-style:none;padding:0;margin:0;width:100%}.sidebar-nav li{margin:5px 0}.sidebar-nav a{display:flex;align-items:center;gap:12px;padding:12px 20px;color:#ccc;text-decoration:none;border-radius:8px;transition:all .2s ease;font-size:.95rem}.sidebar-nav a:hover{background-color:#2a2d3e;color:#4a9eff}.sidebar-nav li.active a{background-color:#4a9eff;color:#fff}.sidebar-nav svg{flex-shrink:0}.main-wrapper{flex:1;margin-left:250px;margin-right:280px;min-height:100vh;padding:30px 40px;max-width:950px}.sidebar-right{width:280px;min-width:280px;background-color:#151822;border-left:1px solid #2a2d3e;position:fixed;right:0;top:0;height:100vh;overflow-y:auto;z-index:100}.sidebar-right__inner{padding:30px 20px}.widget{margin-bottom:30px}.widget-title{font-size:1rem;color:#fff;margin:0 0 15px;padding-bottom:10px;border-bottom:1px solid #2a2d3e}.widget-list{list-style:none;padding:0;margin:0}.widget-list li{margin:8px 0}.widget-list a{color:#ccc;text-decoration:none;font-size:.9rem;display:block;padding:5px 0;transition:color .2s ease}.widget-list a:hover{color:#4a9eff}.widget-tags{display:flex;flex-wrap:wrap;gap:8px}.widget-tag{display:inline-block;padding:5px 12px;background-color:#2a2d3e;color:#ccc;text-decoration:none;border-radius:15px;font-size:.8rem;transition:all .2s ease}.widget-tag:hover{background-color:#4a9eff;color:#fff}.widget-tag .count{margin-left:5px;opacity:.7}.archives h1{color:#4a9eff;margin-bottom:30px}.archive-year h2{color:#4a9eff;font-size:1.3rem;margin:25px 0 15px;padding-left:10px;border-left:3px solid #4a9eff}.archive-posts{list-style:none;padding:0;margin:0}.archive-posts li{padding:8px 0;display:flex;align-items:center;gap:15px}.archive-date{color:#888;font-size:.85rem;min-width:60px}.archive-posts a{color:#ccc;text-decoration:none}.archive-posts a:hover{color:#4a9eff}body.three-column-layout .header{display:none}@media(max-width:1200px){.sidebar-right{display:none}.main-wrapper{margin-right:0}}@media(max-width:768px){body.three-column-layout{flex-direction:column}.sidebar-left{width:100%;min-width:100%;position:relative;height:auto;border-right:none;border-bottom:1px solid #2a2d3e}.sidebar-left__inner{padding:20px;height:auto}.sidebar-nav ul{display:flex;flex-wrap:wrap;justify-content:center;gap:5px}.sidebar-nav a{padding:8px 15px}.avatar-img,.avatar-placeholder{width:80px;height:80px;font-size:2rem}.main-wrapper{margin-left:0;padding:20px}.sidebar-right{display:none}.sidebar-social{position:relative;bottom:auto;margin-top:15px}}@media(max-width:768px){.sidebar-social{position:relative!important;bottom:auto!important;width:100%!important;margin-top:20px!important;padding-top:15px!important;border-top:1px solid #2a2d3e}.sidebar-nav ul{width:100%}}@media(max-width:768px){.main-wrapper{overflow-x:hidden!important;max-width:100vw!important}article img,.post-content img,.content img{max-width:100%!important;height:auto!important}pre,code{max-width:100%!important;overflow-x:auto!important;white-space:pre-wrap!important;word-wrap:break-word!important}.post-title,article h1,article h2{word-wrap:break-word!important;overflow-wrap:break-word!important}}.search-widget{margin-bottom:25px}.search-box{position:relative;display:flex;align-items:center}.search-icon{position:absolute;left:12px;color:#888;pointer-events:none}#search-input{width:100%;padding:12px 15px 12px 40px;background-color:#2a2d3e;border:1px solid #3a3d4e;border-radius:8px;color:#fff;font-size:.9rem;outline:none;transition:all .2s ease}#search-input:focus{border-color:#4a9eff;box-shadow:0 0 0 3px rgba(74,158,255,.2)}#search-input::placeholder{color:#666}#search-results{margin-top:10px;max-height:400px;overflow-y:auto}#search-results:empty{display:none}.search-result-item{padding:10px;margin:5px 0;background-color:#2a2d3e;border-radius:6px;transition:background-color .2s ease}.search-result-item:hover{background-color:#3a3d4e}.search-result-item a{color:#4a9eff;text-decoration:none;font-size:.9rem;display:block}.search-result-item .search-date{font-size:.75rem;color:#888;margin-top:3px}.search-result-item .search-snippet{font-size:.8rem;color:#aaa;margin-top:5px;line-height:1.4}.search-no-results{color:#888;font-size:.85rem;padding:10px;text-align:center}.post-featured-image{margin:20px 0 30px;border-radius:8px;overflow:hidden}.post-featured-image img{width:100%;height:auto;display:block}.terms h1{color:#4a9eff!important;margin-bottom:20px}.terms ul{list-style:none!important;padding:0;margin:0}.terms li{margin:12px 0;display:flex;align-items:center;gap:10px}.terms li::before{display:none!important;content:none!important}.terms li svg{color:#4a9eff!important;flex-shrink:0}.terms a,.terms li a,.terms ul li a{color:#4a9eff!important;text-decoration:none!important;font-size:1.1rem;transition:color .2s ease}.terms a:hover,.terms li a:hover,.terms ul li a:hover{color:#6bb0ff!important}.main-wrapper{margin:0 auto!important}.avatar-img{width:300px!important;height:auto!important;border-radius:20px!important;object-fit:contain!important}.sidebar-social{display:flex;gap:15px;justify-content:center;position:absolute;bottom:30px;left:0;right:0}.sidebar-social a{color:#888;transition:color .2s ease}.sidebar-social a:hover{color:#4a9eff}blockquote{border-left:4px solid red!important;background-color:rgba(255,107,107,3%)!important;background-color:transparent!important;margin:1.5em 0!important;padding:15px 20px!important;border-radius:0 8px 8px 0!important;color:#ccc!important;border-top:none!important;border-right:none!important;border-bottom:none!important}blockquote p{margin:0!important}blockquote::before{content:none!important;display:none!important}pre{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-x:hidden!important}pre code{white-space:pre-wrap!important;word-wrap:break-word!important}table,th,td{border-width:2px!important;border-color:#2a2d3e!important}.toc-container{background:#1e2030;border:1px solid #444;border-left:3px solid #4caf50;border-radius:4px;padding:1rem 1.5rem;margin:1.5rem 0 2rem}.toc-title{color:#4caf50;font-weight:700;font-size:.95rem;cursor:pointer;user-select:none;letter-spacing:.05em}.toc-title:hover{color:#80e060}#TableOfContents ul{list-style:none;padding-left:1rem;margin:.5rem 0 0}#TableOfContents li{margin:.3rem 0}#TableOfContents ul ul li{font-size:.82rem}#TableOfContents a{color:#aaa;text-decoration:none;font-size:.9rem}#TableOfContents a:hover{color:#ff7a00;text-decoration:underline}</style></head><body class=three-column-layout><aside class=sidebar-left><div class=sidebar-left__inner><div class=sidebar-avatar><a href=https://halfoncloud.com/><img src=/images/avatar.png alt=HalfOnCloud class=avatar-img></a></div><h2 class=sidebar-title><a href=https://halfoncloud.com/>Half<span class=red>On</span>Cloud</a></h2><p class=sidebar-tagline>IT tutorials, automation scripts, and real-world solutions</p><nav class=sidebar-nav><ul><li><a href=https://halfoncloud.com/><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
Home</a></li><li><a href=https://halfoncloud.com/categories/><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
Categories</a></li><li><a href=https://halfoncloud.com/tags/><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
Tags</a></li><li><a href=https://halfoncloud.com/archives/><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
Archives</a></li><li><a href=https://halfoncloud.com/about/><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
About</a></li></ul></nav><div class=sidebar-social><a href=https://x.com/HeyRadu target=_blank rel=noopener title=X/Twitter><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href=https://linkedin.com/in/radu-bogdan target=_blank rel=noopener title=LinkedIn><svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></a></div></div></aside><aside class=sidebar-right><div class=sidebar-right__inner><div class="widget search-widget"><div class=search-box><svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
<input type=text id=search-input placeholder=Search... autocomplete=off></div><div id=search-results></div></div><div class=widget><h3 class=widget-title>Recent Posts</h3><ul class=widget-list><li><a href=https://halfoncloud.com/posts/pinning-a-custom-url-to-the-windows-taskbar-via-intune/>Pinning a Custom URL to the Windows Taskbar via Intune</a></li><li><a href=https://halfoncloud.com/posts/onedrive-silentaccountconfig-troubleshooting-the-zero-sign-in-log-clue/>OneDrive Silent Config Not Working? Why the Sign-In Logs Hold the Answer</a></li><li><a href=https://halfoncloud.com/posts/privacy-policy/>Privacy Policy</a></li><li><a href=https://halfoncloud.com/posts/m365-business-premium-part-8-anatomy-of-a-failed-enrollment-tracing-an-esp-error-from-screen-to-root-cause/>M365 Business Premium Part 8: Anatomy of a Failed Enrollment - Tracing an ESP Error from Screen to Root Cause</a></li><li><a href=https://halfoncloud.com/posts/m365-business-premium-part-7-intune-autopilot/>M365 Business Premium Part 7: Intune Autopilot Deployment Walkthrough</a></li></ul></div><div class=widget><h3 class=widget-title>Categories</h3><div class=widget-tags><a href=https://halfoncloud.com/categories/%23deliveryoptimization/ class=widget-tag>#DeliveryOptimization <span class=count>1</span>
</a><a href=https://halfoncloud.com/categories/%23m365apps/ class=widget-tag>#M365Apps <span class=count>1</span>
</a><a href=https://halfoncloud.com/categories/%23msintune/ class=widget-tag>#MSIntune  <span class=count>1</span>
</a><a href=https://halfoncloud.com/categories/%23powershell/ class=widget-tag>#PowerShell <span class=count>1</span>
</a><a href=https://halfoncloud.com/categories/%23win32/ class=widget-tag>#Win32  <span class=count>1</span>
</a><a href=https://halfoncloud.com/categories/cloud/ class=widget-tag>Cloud <span class=count>13</span>
</a><a href=https://halfoncloud.com/categories/general/ class=widget-tag>General <span class=count>1</span></a></div></div><div class=widget><h3 class=widget-title>Tags</h3><div class=widget-tags><a href=https://halfoncloud.com/tags/%23layoutxml/ class=widget-tag>#LayoutXML <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/about/ class=widget-tag>About <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/autopilot/ class=widget-tag>Autopilot <span class=count>2</span>
</a><a href=https://halfoncloud.com/tags/compliancepolicies/ class=widget-tag>CompliancePolicies <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/configurationprofiles/ class=widget-tag>ConfigurationProfiles <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/ddm/ class=widget-tag>DDM <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/devicemanagement/ class=widget-tag>DeviceManagement <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/entraid/ class=widget-tag>EntraID <span class=count>6</span>
</a><a href=https://halfoncloud.com/tags/esp/ class=widget-tag>ESP <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/licensing/ class=widget-tag>Licensing <span class=count>3</span>
</a><a href=https://halfoncloud.com/tags/m365/ class=widget-tag>M365 <span class=count>5</span>
</a><a href=https://halfoncloud.com/tags/mmp-c/ class=widget-tag>MMP-C <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/msintune/ class=widget-tag>MSIntune <span class=count>14</span>
</a><a href=https://halfoncloud.com/tags/onedrive/ class=widget-tag>OneDrive <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/powershell/ class=widget-tag>PowerShell <span class=count>2</span>
</a><a href=https://halfoncloud.com/tags/security/ class=widget-tag>Security <span class=count>1</span>
</a><a href=https://halfoncloud.com/tags/win32/ class=widget-tag>Win32 <span class=count>2</span>
</a><a href=https://halfoncloud.com/tags/win32apps/ class=widget-tag>Win32Apps <span class=count>2</span>
</a><a href=https://halfoncloud.com/tags/windc/ class=widget-tag>WinDC <span class=count>1</span></a></div></div></div></aside><div class=main-wrapper><div class=content><article class=post><header class=post-header><h1 class=post-title>Pinning a Custom URL to the Windows Taskbar via Intune</h1><div class=post-meta><time class=post-date>2026-02-21 · 12 min read</time>
<span class=post-author>Radu Bogdan</span></div><span class=post-tags>#<a href=https://halfoncloud.com/tags/msintune/>MSIntune</a>&nbsp;
#<a href=https://halfoncloud.com/tags/win32apps/>Win32Apps</a>&nbsp;
#<a href=https://halfoncloud.com/tags/#layoutxml/>#LayoutXML</a>&nbsp;</span></header><div class=post-content><div class=toc-container><details><summary class=toc-title>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#a-question-from-the-community>A Question From the Community</a><ul><li><a href=#why-this-seems-harder-than-it-looks>Why This Seems Harder Than It Looks</a></li></ul></li><li><a href=#how-this-works>How This Works</a><ul><li><a href=#component-1-the-win32-app>Component 1: The Win32 App</a></li><li><a href=#detection-rule>Detection Rule</a></li><li><a href=#component-2-the-taskbar-layout-xml-policy>Component 2: The Taskbar Layout XML Policy</a></li><li><a href=#the-json-layout>The JSON Layout</a></li></ul></li><li><a href=#why-formatting-matters-more-than-you-think>Why Formatting Matters More Than You Think</a><ul><li><a href=#successful-installation>Successful Installation</a></li><li><a href=#policy-deployment-confirmed>Policy Deployment Confirmed</a></li></ul></li><li><a href=#lessons-learned>Lessons Learned</a></li></ul></nav></details></div><h2 id=a-question-from-the-community>A Question From the Community</h2><p>Recently I&rsquo;ve came across someone in the LinkedIn MEM community asking for a solution regarding a website URL that needed to be pinned to the Windows taskbar through Microsoft Intune with a custom icon, so clicking on it would simply open a browser page (Edge) automatically loading a specific URL. They had already tried the obvious approach by deploying the shortcut as a Win32 app and reference it in a Taskbar Layout XML policy but without too much success.</p><p>In this article I&rsquo;ll share one possible solution along with the reasoning behind each step, so you can also follow the logic and build on it in your own environment.</p><h3 id=why-this-seems-harder-than-it-looks>Why This Seems Harder Than It Looks</h3><p>What someone would usually try first is to deploy a <em>.url</em> file or a <em>.lnk</em> shortcut as a Win32 app, then reference it in a Taskbar Layout XML policy which is a clean and simple method but the problem is a fundamental Windows constraint: Win32 apps in Intune run as SYSTEM while taskbar pinning is a per-user operation.</p><p>When your Win32 app runs as SYSTEM and drops files on disk, that part works great but when Windows processes the Taskbar Layout XML policy, it needs the shortcut to already exist and it needs to apply the pin in the user&rsquo;s context. If the shortcut isn&rsquo;t there or if the policy fires before the user logs on for the first time after enrollment, the entry is silently ignored without any clues or errors.</p><p>So the solution has two distinct parts that must deploy in the right order:</p><ol><li>A Win32 app that places the shortcut (.lnk) and icon (.ico) on disk, preferably into a system accessible location.</li><li>A Taskbar Layout XML policy that references that .lnk path and pins it to the taskbar.</li></ol><h2 id=how-this-works>How This Works</h2><p>Before looking at the script itself, it&rsquo;s worth understanding the architecture behind this solution because there are actually two components working together so one cannot work without the other:</p><p><strong>Component 1: The Win32 App</strong></p><p>This is a simple PowerShell script deployed as a Win32 app via Intune, running as SYSTEM. It&rsquo;s only job is placing two files on disk:</p><ul><li><em>HalfOnCloud.lnk</em> - the shortcut pointing to Edge browser opening a URL (in my case my very own blog halfoncloud.com)</li><li><em>HalfOnCloud.ico</em> - the custom icon</li></ul><p>Both land in the location <em>C:\ProgramData\HalfOnCloud</em> which is a system-wide location accessible regardless of which user logs in.</p><blockquote><p>Note: The Win32 app writes to <strong>C:\ProgramData</strong> because SYSTEM has no user profile and the XML policy reads from there because the path must be valid for every user on the device.</p></blockquote><p><strong>Component 2: The XML Layout Policy</strong></p><p>This is an existing Intune Settings Catalog policy that defines the taskbar layout. It references the .lnk file path created by the Win32 app and pins it to the taskbar at the user&rsquo;s logon.</p><p><strong>The dependency</strong></p><p>The Win32 app must be installed before the user logs in otherwise the XML policy applies at logon but the <em>.lnk</em> doesn&rsquo;t exist yet and the pin silently fails. On Autopilot deployments this timing depends on your ESP configuration, if the app is added to the ESP blocking apps list, Intune guarantees it installs before the user ever reaches the desktop, making the pin available from the very first logon. If it is not in the ESP blocking list then the app installs post enrollment once the device receives and processes its assigned applications, in that case the pin appears on the next logon after that sync completes.</p><h3 id=component-1-the-win32-app>Component 1: The Win32 App</h3><p>The package contains three files, two PowerShell scripts and the custom icon, all three are part of a &ldquo;Source&rdquo; folder from which the application was created initially.</p><p><strong>Add_TaskbarShortcut.ps1</strong> is the install script which runs as SYSTEM via Intune and is responsible for placing the two files, the XML Layout policy depends on the <em>.lnk</em> shortcut and the <em>.ico</em> icon into <em>C:\ProgramData\HalfOnCloud</em>. It also creates the detection marker file so Intune knows the app installed successfully.</p><p><strong>Remove_TaskbarShortcut.ps1</strong> is the uninstall script which cleans up everything the install script created and removes everything from the custom &ldquo;HalfOnCloud&rdquo; folder. After uninstall the XML Layout policy will still reference the .lnk path but since the file no longer exists the pin simply won&rsquo;t appear at the next logon.</p><p><strong>HalfOnCloud.ico</strong> is the custom icon that gets copied to disk during installation and referenced by both the <em>.lnk</em> shortcut and the XML Layout policy.</p><blockquote><p>Note: The icon must be a genuine <strong>.ico</strong> format file not a renamed <em>.png</em> or <em>.jpg</em>, otherwise Windows will fail silently if the format is wrong, displaying either a blank icon or nothing at all on the taskbar.</p></blockquote><p><img src=/images/Blog_P19_015.jpg alt></p><p><strong>Add_TaskbarShortcut.ps1</strong> script contents:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span>New-Item -Path <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud&#34;</span> -ItemType Directory -Force | Out-Null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$LogPath</span> = <span style=color:#48b685>&#34;C:\ProgramData\Microsoft\IntuneManagementExtension\Logs\HalfOnCloud-TaskbarPin-Install.log&#34;</span>
</span></span><span style=display:flex><span>Start-Transcript -Path <span style=color:#ef6155>$LogPath</span> -Force
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copy-Item <span style=color:#48b685>&#34;.\HalfOnCloud.ico&#34;</span> -Destination <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.ico&#34;</span> -Force
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shell</span> = New-Object -ComObject <span style=color:#48b685>&#34;WScript.Shell&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span> = <span style=color:#ef6155>$Shell</span>.CreateShortcut(<span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.lnk&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.TargetPath   = <span style=color:#48b685>&#34;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.Arguments    = <span style=color:#48b685>&#34;https://www.halfoncloud.com&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.Description  = <span style=color:#48b685>&#34;HalfOnCloud&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.IconLocation = <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.ico&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.Save()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>New-Item -Path <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud&#34;</span> -Name <span style=color:#48b685>&#34;Installed_v1.0.txt&#34;</span> -ItemType File -Force
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Stop-Transcript
</span></span></code></pre></div><p><strong>Remove_TaskbarShortcut.ps1</strong> script contents:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#ef6155>$LogPath</span> = <span style=color:#48b685>&#34;C:\ProgramData\Microsoft\IntuneManagementExtension\Logs\HalfOnCloud-TaskbarPin-Uninstall.log&#34;</span>
</span></span><span style=display:flex><span>Start-Transcript -Path <span style=color:#ef6155>$LogPath</span> -Force
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Remove-Item -Path <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.lnk&#34;</span> -Force -ErrorAction SilentlyContinue
</span></span><span style=display:flex><span>Remove-Item -Path <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.ico&#34;</span> -Force -ErrorAction SilentlyContinue
</span></span><span style=display:flex><span>Remove-Item -Path <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\Installed_v1.0.txt&#34;</span> -Force -ErrorAction SilentlyContinue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Stop-Transcript
</span></span></code></pre></div><p>The new app In Intune, in my case named &ldquo;<em>GBL-WIN11-HalfOnCloudTaskbarPin</em>&rdquo;, is configured using the newer PowerShell script method (cleaner modern way rather than the traditional install command approach), both Install script and Uninstall script referencing the two PowerShell files directly:</p><p><img src=/images/Blog_P19_019.jpg alt></p><h3 id=detection-rule>Detection Rule</h3><p>I&rsquo;ve choose to keep the Detection Rule quite simple here using a plain file check with no custom script required.</p><p>Intune looks for the presence of the file <em>Installed_v1.0.txt</em> inside <em>C:\ProgramData\HalfOnCloud</em>, if the file exists the app is considered installed and if it doesn&rsquo;t exist Intune will attempt to install it. This file is created as the very last step of <em>Add_TaskbarShortcut.ps1</em> meaning it only appears after every other operation has completed successfully, making it a reliable indicator of a clean install.</p><p><strong>Rule type:</strong> File
<strong>Path:</strong> C:\ProgramData\HalfOnCloud
<strong>File or folder:</strong> Installed_v1.0.txt
<strong>Detection method:</strong> File or folder exists
<strong>Associated with a 32-bit app:</strong> No</p><p><img src=/images/Blog_P19_016.jpg alt></p><h3 id=component-2-the-taskbar-layout-xml-policy>Component 2: The Taskbar Layout XML Policy</h3><p>This is the second and equally important half of the solution, the configuration profile &ldquo;<em>GBL-WIN11-StartMenu-Taskbar-Layout-(PRD)</em>&rdquo; already existed in my tenant managing the taskbar layout so all I had to do was to add one extra line referencing the <em>.lnk</em> file that the Win32 app places on disk.</p><p>The XML defines four pins in this order: Edge, File Explorer, Outlook and HalfOnCloud.</p><p>The <em>PinListPlacement=&ldquo;Replace&rdquo;</em> attribute means this list completely replaces whatever was previously pinned and nothing carries over from the default Windows taskbar.
The <em>PinGeneration=&ldquo;1&rdquo;</em> attribute on each entry allows users to unpin items if they choose to, without the policy forcing them back on the next sync cycle.</p><p><strong>TaskbarLayout.xml</strong> contents:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#776e71>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span> <span style=color:#5bc4bf>&lt;LayoutModificationTemplate</span> <span style=color:#06b6ef>xmlns=</span><span style=color:#48b685>&#34;http://schemas.microsoft.com/Start/2014/LayoutModification&#34;</span> <span style=color:#06b6ef>xmlns:defaultlayout=</span><span style=color:#48b685>&#34;http://schemas.microsoft.com/Start/2014/FullDefaultLayout&#34;</span> <span style=color:#06b6ef>xmlns:start=</span><span style=color:#48b685>&#34;http://schemas.microsoft.com/Start/2014/StartLayout&#34;</span> <span style=color:#06b6ef>xmlns:taskbar=</span><span style=color:#48b685>&#34;http://schemas.microsoft.com/Start/2014/TaskbarLayout&#34;</span> <span style=color:#06b6ef>Version=</span><span style=color:#48b685>&#34;1&#34;</span><span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>&lt;CustomTaskbarLayoutCollection</span> <span style=color:#06b6ef>PinListPlacement=</span><span style=color:#48b685>&#34;Replace&#34;</span><span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>&lt;defaultlayout:TaskbarLayout&gt;</span> <span style=color:#5bc4bf>&lt;taskbar:TaskbarPinList&gt;</span> <span style=color:#5bc4bf>&lt;taskbar:DesktopApp</span> <span style=color:#06b6ef>DesktopApplicationID=</span><span style=color:#48b685>&#34;MSEdge&#34;</span> <span style=color:#06b6ef>PinGeneration=</span><span style=color:#48b685>&#34;1&#34;</span> <span style=color:#5bc4bf>/&gt;</span> <span style=color:#5bc4bf>&lt;taskbar:DesktopApp</span> <span style=color:#06b6ef>DesktopApplicationID=</span><span style=color:#48b685>&#34;Microsoft.Windows.Explorer&#34;</span> <span style=color:#06b6ef>PinGeneration=</span><span style=color:#48b685>&#34;1&#34;</span> <span style=color:#5bc4bf>/&gt;</span> <span style=color:#5bc4bf>&lt;taskbar:UWA</span> <span style=color:#06b6ef>AppUserModelID=</span><span style=color:#48b685>&#34;Microsoft.OutlookForWindows_8wekyb3d8bbwe!Microsoft.OutlookforWindows&#34;</span> <span style=color:#06b6ef>PinGeneration=</span><span style=color:#48b685>&#34;1&#34;</span> <span style=color:#5bc4bf>/&gt;</span> <span style=color:#5bc4bf>&lt;taskbar:DesktopApp</span> <span style=color:#06b6ef>DesktopApplicationLinkPath=</span><span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.lnk&#34;</span> <span style=color:#06b6ef>PinGeneration=</span><span style=color:#48b685>&#34;1&#34;</span> <span style=color:#5bc4bf>/&gt;</span> <span style=color:#5bc4bf>&lt;/taskbar:TaskbarPinList&gt;</span> <span style=color:#5bc4bf>&lt;/defaultlayout:TaskbarLayout&gt;</span> <span style=color:#5bc4bf>&lt;/CustomTaskbarLayoutCollection&gt;</span> <span style=color:#5bc4bf>&lt;/LayoutModificationTemplate&gt;</span>
</span></span></code></pre></div><h3 id=the-json-layout>The JSON Layout</h3><p>The <em>StartMenuLayout.json</em> handles the Start Menu pins separately from the taskbar, these are two completely independent configurations despite existing in the same policy. The <em>&ldquo;applyOnce&rdquo;: true</em> property is important because it means the layout is stamped once at first logon and then the user is free to reorganize their Start Menu however they like without the policy overwriting their changes on every sync.</p><p>The pinned list covers the core productivity apps: Edge, Word, Excel, PowerPoint, Outlook classic and Company Portal, giving every user a consistent starting point from day one without locking them into it permanently.</p><p><img src=/images/Blog_P19_018.jpg alt></p><p><strong>StartMenuLayout.json</strong> contents:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#5bc4bf>&#34;applyOnce&#34;</span>:<span style=color:#815ba4>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#5bc4bf>&#34;pinnedList&#34;</span>:[
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;desktopAppLink&#34;</span>:<span style=color:#48b685>&#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Microsoft Edge.lnk&#34;</span>},
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;desktopAppLink&#34;</span>:<span style=color:#48b685>&#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Word.lnk&#34;</span>},
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;desktopAppLink&#34;</span>:<span style=color:#48b685>&#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Excel.lnk&#34;</span>},
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;desktopAppLink&#34;</span>:<span style=color:#48b685>&#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\PowerPoint.lnk&#34;</span>},
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;desktopAppLink&#34;</span>:<span style=color:#48b685>&#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Outlook (classic).lnk&#34;</span>},
</span></span><span style=display:flex><span>    {<span style=color:#5bc4bf>&#34;packagedAppId&#34;</span>:<span style=color:#48b685>&#34;Microsoft.CompanyPortal_8wekyb3d8bbwe!App&#34;</span>}
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=/images/Blog_P19_017.jpg alt></p><h2 id=why-formatting-matters-more-than-you-think>Why Formatting Matters More Than You Think</h2><p>Both the <em>TaskbarLayout.xml</em> and <em>StartMenuLayout.json</em> files look intuitive enough but I&rsquo;ve noticed that even a single formatting mistake could cause silent failures with no visible errors in the Intune portal or no warnings on the device itself, the policy simple doesn&rsquo;t apply.</p><p>When you paste the <em>TaskbarLayout.xml</em> content into the Intune Settings Catalog field, it must be entered as a single continuous line with no line breaks. This is not very obvious and Microsoft doesn&rsquo;t directly warn you about it anywhere in the portal so if you paste it formatted with proper indentation as you would normally write XML, the policy will appear as successfully applied in Intune but nothing happens on the device and the taskbar simply won&rsquo;t reflect any changes.</p><p>The JSON <em>StartMenuLayout.json</em> cannot have extra spaces or formatting either and has the same sensitivity, during my own testing I encountered error code <strong>65000</strong> directly caused by formatting spaces left in the JSON value. Again Intune gave me no meaningful error message pointing to the formatting as the cause, so I had to trial and error.</p><p>With most Intune policies any failure will show up clearly in the device&rsquo;s policy report, but with these taskbar and Start Menu layout configurations the failure mode is a bit subtle, the policy reports as successfully delivered but the layout simply doesn&rsquo;t apply. This makes it easy to assume the policy is working when in fact it isn&rsquo;t, especially on a device that has been through multiple test cycles where old cached state may still be visible.</p><h3 id=successful-installation>Successful Installation</h3><p>This following image confirms everything worked as expected after the app installed successfully, the &ldquo;<em>C:\ProgramData\HalfOnCloud</em>&rdquo; folder was created by the install script containing three files:</p><ul><li><strong>HalfOnCloud.ico</strong>: the custom icon copied from the package during installation</li><li><strong>HalfOnCloud.lnk</strong>: the shortcut pointing to Edge opening the URL halfoncloud.com (the small arrow overlay confirming it&rsquo;s a proper Windows shortcut file)</li><li><strong>Installed_v1.0.txt</strong>: the detection marker file that tells Intune the app is installed</li></ul><p>Notice the HalfOnCloud icon is also pinned on the taskbar exactly where it should be, a definitive proof that both components did their job, the script delivered the files and the XML policy handled the pin.</p><p><img src=/images/Blog_P19_008.jpg alt></p><p>Clicking the pinned icon on the taskbar opens Edge and navigates directly to the URL, exactly as defined in the <em>Arguments</em> line of the install script:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#ef6155>$Shortcut</span>.Arguments = <span style=color:#48b685>&#34;https://www.halfoncloud.com&#34;</span>
</span></span></code></pre></div><p><img src=/images/Blog_P19_009.jpg alt></p><p>Optionally, you can check the <em>Target</em> field in the shortcut properties which confirms exactly what the install script was instructed to do:</p><p><em>&ldquo;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe&rdquo; <a href=https://www.halfoncloud.com>https://www.halfoncloud.com</a></em></p><p>Msedge.exe is the target executable and Edge browser is the launcher, the URL is passed as the argument telling Edge which URL to open. Windows combines <em>TargetPath</em> and <em>Arguments</em> from the script into this single Target field automatically.</p><blockquote><p><strong>Note</strong>: Totally optionally of course but you can also make use of the <strong>&ndash;app=</strong> flag here, which can open the URL in Edge PWA mode as a stripped-down window with no address bar.</p></blockquote><p><img src=/images/Blog_P19_020.jpg alt></p><h3 id=policy-deployment-confirmed>Policy Deployment Confirmed</h3><p>This is the final piece of the puzzle, the Intune device configuration profile &ldquo;<em>GBL-WIN11-StartMenu-Taskbar-Layout-(PRD)</em>&rdquo; reporting <strong>Succeeded</strong> on my device with no errors or conflicts. Getting a clean success here means both the TaskbarLayout.xml and the StartMenuLayout.json have been properly formatted and applied.</p><p><img src=/images/Blog_P19_006.jpg alt></p><h2 id=lessons-learned>Lessons Learned</h2><p>This solution looks quite straightforward but getting here involved more testing than I&rsquo;d like to admit. Here&rsquo;s what I discovered along the way that is either not completely addressed into the official documentation or its hidden within multiple online resources.</p><p><strong>The scheduled task rabbit hole</strong></p><p>My initial approach was to handle everything inside the Win32 app deploy the files and pin the shortcut programmatically without relying on any separate policy. This led me down the scheduled task path: register a task that fires at logon, copies the <em>.lnk</em> into the user&rsquo;s personal taskbar folder, then self-deletes.</p><p>Unfortunately this method doesn&rsquo;t work on Windows 11 (v25H2), the file lands in the correct folder indeed and the task reports as run successfully but nothing appears on the taskbar. I&rsquo;ve then manually restarted Explorer as an additional troubleshooting step hoping it would force a refresh but it didn&rsquo;t make any difference either. Based on my extended research seems that Microsoft silently removed the support for this method somewhere around Windows 10 21H2 version, the taskbar now maintains its own internal database and simply ignores files dropped into that folder programmatically.</p><p>If you are curios here is the PS code that runs successfully but ultimately does nothing on Windows 11 but maybe worth keeping in mind if you ever come across similar solutions online:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#ef6155>$destination</span> = <span style=color:#48b685>&#34;</span><span style=color:#ef6155>$env:APPDATA</span><span style=color:#48b685>\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar&#34;</span>
</span></span><span style=display:flex><span>Copy-Item <span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud\HalfOnCloud.lnk&#34;</span> -Destination <span style=color:#48b685>&#34;</span><span style=color:#ef6155>$destination</span><span style=color:#48b685>\HalfOnCloud.lnk&#34;</span> -Force
</span></span><span style=display:flex><span>Unregister-ScheduledTask -TaskName <span style=color:#48b685>&#34;PinHalfOnCloudToTaskbar&#34;</span> -Confirm:<span style=color:#ef6155>$false</span>
</span></span></code></pre></div><blockquote><p><strong>Note</strong>: Microsoft never officially announced the removal of this method it simply stopped working, and there is no documentation acknowledging this change, which is exactly why it keeps appearing as a suggested solution online even though it no longer works on Windows 11.</p></blockquote><p><strong>The <em>InvokeVerb(&ldquo;TaskbarPin&rdquo;)</em> dead end</strong></p><p>While troubleshooting the above I also came across the <em>Shell COM object</em> approach that appears frequently in various community articles. This confirmed it runs without errors but does absolutely nothing on Windows 11 so I didn&rsquo;t bother really testing it, most likely another method which Microsoft quietly dismissed along the way.</p><p>And here is the Shell COM object approach you&rsquo;ll find suggested online, which looks interesting but again achieves absolutely nothing on Windows 11:</p><div class=highlight><pre tabindex=0 style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span><span style=color:#ef6155>$shell</span> = New-Object -ComObject Shell.Application
</span></span><span style=display:flex><span><span style=color:#ef6155>$folder</span> = <span style=color:#ef6155>$shell</span>.Namespace(<span style=color:#48b685>&#34;C:\ProgramData\HalfOnCloud&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ef6155>$item</span> = <span style=color:#ef6155>$folder</span>.ParseName(<span style=color:#48b685>&#34;HalfOnCloud.lnk&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ef6155>$item</span>.InvokeVerb(<span style=color:#48b685>&#34;TaskbarPin&#34;</span>)
</span></span></code></pre></div><p><strong>The real fix</strong></p><p>The actual solution turned out to be simpler, leveraging the existing XML Layout policy &ldquo;<em>GBL-WIN11-StartMenu-Taskbar-Layout-(PRD)</em>&rdquo; which I&rsquo;ve already had it configured into my Intune tenant, so once I added the <em>.lnk</em> path to the XML, the taskbar pin worked correctly at logon so no need for any scheduled task, unnecessary shell manipulation or any use of COM objects.</p><p>Also worth being totally transparent here, the policy applies at logon and not immediately, so a sign out and sign back in is required after the app installs for the taskbar pin to appear for the first time.</p><p><strong>Test environment gotchas</strong></p><p>After multiple installs, uninstalls and reinstalls cycles on the same device, reproducing consistent behavior had become unreliable, the taskbar database accumulates cached sessions and doesn&rsquo;t always behave predictably on a heavily tested device. If you&rsquo;re testing this solution your cleanest result will always come from a fresh Autopilot enrollment and not a device that&rsquo;s been through multiple rounds of testing.</p><hr><p>If you&rsquo;ve tackled this differently or found a cleaner approach, I&rsquo;d be curious to hear about it so feel free to reach out on LinkedIn.</p><p>Thank you.</p></div><footer class=post-footer><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><a href=https://halfoncloud.com/posts/onedrive-silentaccountconfig-troubleshooting-the-zero-sign-in-log-clue/ class="button inline next">[<span class=button__text>OneDrive Silent Config Not Working? Why the Sign-In Logs Hold the Answer</span>] ></a></div></div></footer></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user" style=text-align:center><span>&copy; 2026 Radu Bogdan :: HalfOnCloud</span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><style>.image-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);z-index:9999;cursor:pointer;justify-content:center;align-items:center}.image-overlay.active{display:flex}.image-overlay img{max-width:95%;max-height:95%;border:2px solid #fff;object-fit:contain}article img{cursor:pointer}</style><div class=image-overlay id=imageOverlay><img src alt="Enlarged image" id=overlayImage></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("imageOverlay"),t=document.getElementById("overlayImage");document.querySelectorAll("article img").forEach(function(n){n.addEventListener("click",function(){t.src=this.src,e.classList.add("active")})}),e.addEventListener("click",function(){e.classList.remove("active")}),document.addEventListener("keydown",function(t){t.key==="Escape"&&e.classList.remove("active")}),document.querySelectorAll("article pre").forEach(function(e){var t,n=document.createElement("div");n.style.position="relative",e.parentNode.insertBefore(n,e),n.appendChild(e),t=document.createElement("button"),t.textContent="Copy",t.style.cssText="position:absolute; top:5px; right:5px; background:rgba(74,158,255,0.15); color:#4a9eff; border:1px solid rgba(74,158,255,0.3); padding:2px 8px; border-radius:3px; cursor:pointer; font-size:0.7rem; opacity:0.5; transition:opacity 0.2s; z-index:10;",t.addEventListener("mouseenter",function(){t.style.opacity="1"}),t.addEventListener("mouseleave",function(){t.style.opacity="0.7"}),t.addEventListener("click",function(){var n=e.querySelector("code")?e.querySelector("code").textContent:e.textContent;navigator.clipboard.writeText(n).then(function(){t.textContent="Copied!",t.style.background="rgba(34,197,94,0.15)",t.style.color="#22c55e",t.style.borderColor="rgba(34,197,94,0.3)",setTimeout(function(){t.textContent="Copy",t.style.background="rgba(74,158,255,0.15)",t.style.color="#4a9eff",t.style.borderColor="rgba(74,158,255,0.3)"},2e3)})}),n.appendChild(t)})})</script><script>(function(){let n=null;const t=document.getElementById("search-input"),e=document.getElementById("search-results");if(!t||!e)return;fetch("/index.json").then(e=>e.json()).then(e=>{n=e}).catch(e=>console.log("Search index not found"));function o(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}function s(t){if(!n||t.length<2){e.innerHTML="";return}const s=n.filter(e=>{const n=(e.title+" "+e.contents+" "+(e.tags||[]).join(" ")).toLowerCase();return n.includes(t.toLowerCase())}).slice(0,8);if(s.length===0){e.innerHTML='<div class="search-no-results">No results found</div>';return}e.innerHTML=s.map(e=>{const o=e.contents.toLowerCase(),i=t.toLowerCase();let n="";const s=o.indexOf(i);if(s!==-1){const o=Math.max(0,s-40),i=Math.min(e.contents.length,s+t.length+60);n=(o>0?"...":"")+e.contents.substring(o,i)+(i<e.contents.length?"...":"")}else n=e.contents.substring(0,100)+"...";return`
                <div class="search-result-item">
                    <a href="${e.permalink}">${e.title}</a>
                    <div class="search-date">${e.date}</div>
                    <div class="search-snippet">${n}</div>
                </div>
            `}).join("")}t.addEventListener("input",o(function(e){s(e.target.value.trim())},300)),document.addEventListener("click",function(n){!t.contains(n.target)&&!e.contains(n.target)&&(e.innerHTML="")}),t.addEventListener("focus",function(){this.value.length>=2&&s(this.value.trim())})})()</script></div></body></html>