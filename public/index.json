[{"categories":["Cloud"],"contents":"The New Way I’ve been packaging Win32 apps for Intune for years using the classic approach: wrap everything into an .intunewin file, include the PowerShell install script and call it from the command line. It works but it has a cost, any small change in the script means a full repackage, re-upload and another round of content processing.\nRecently Microsoft recently introduced a quiet but significant change: PowerShell Script as a native installer type for Win32 apps.\nWith this model, the script is no longer embedded inside the encrypted payload, it lives as editable metadata in Intune similar to detection rules. That means no more rebuilding packages just to fix a typo or add a switch like /norestart.\nThis article walks through a real deployment of 7-Zip 25.01.msi using this new approach. It covers the working folder structure, the packaging process, the Intune configuration and the logs that confirm correct execution.\nSource Folder Structure Before packaging, the MSI installer lives in a dedicated Source folder, each application gets its own directory under my project, with separate Source and Output subfolders:\nSource:\nOutput:\nIntuneWinAppUtil Execution The Microsoft Win32 Content Prep Tool (IntuneWinAppUtil.exe) handles the packaging process, running it from command line shows the complete workflow: source folder validation, file type detection, encryption, SHA256 hash computation and final package generation:\nHere is the PS script \u0026ldquo;Install_7Zip_2501.ps1\u0026rdquo; that I\u0026rsquo;m using for this example:\n# Variables: $PackageName = \u0026#34;7-Zip-25.01-x64\u0026#34; $LogPath = \u0026#34;$env:ProgramData\\Microsoft\\IntuneManagementExtension\\Logs\u0026#34; $MsiFile = \u0026#34;$PSScriptRoot\\7z2501-x64.msi\u0026#34; # Create a custom log for troubleshooting: Start-Transcript -Path \u0026#34;$LogPath\\$PackageName-install.log\u0026#34; -Force -Append try { Write-Host \u0026#34;Starting installation of $PackageName\u0026#34; Write-Host \u0026#34;MSI Path: $MsiFile\u0026#34; Write-Host \u0026#34;Timestamp: $(Get-Date -Format \u0026#39;yyyy-MM-dd HH:mm:ss\u0026#39;)\u0026#34; # Verify if the MSI file exists: if (!(Test-Path $MsiFile)) { Write-Host \u0026#34;ERROR: MSI file not found!\u0026#34; Stop-Transcript exit 1 } # App installation: $arguments = \u0026#34;/i `\u0026#34;$MsiFile`\u0026#34; /qn /norestart\u0026#34; Write-Host \u0026#34;Running: msiexec.exe $arguments\u0026#34; $process = Start-Process -FilePath \u0026#34;msiexec.exe\u0026#34; -ArgumentList $arguments -Wait -PassThru Write-Host \u0026#34;Exit code: $($process.ExitCode)\u0026#34; Stop-Transcript exit $process.ExitCode } catch { Write-Host \u0026#34;ERROR: $($_.Exception.Message)\u0026#34; Stop-Transcript exit 1 } App Information Overview When creating a new app, selecting Windows app (Win32) from the dropdown enables the full Win32 app deployment workflow. From the Intune portal, select \u0026ldquo;Create\u0026rdquo; and from the App type choose \u0026ldquo;Windows app (Win32)\u0026rdquo;.\nAdd the newly created \u0026ldquo;7z2501-x64.intunewin\u0026rdquo; into the \u0026ldquo;Select app package file\u0026rdquo;:\nOnce the intunewim is added continue with the new application customizations.\nThe app name GBL-WIN11-7z2501-x64 follows my own standard pattern, specifying the App name, Description, Publisher, App version and of course the app logo:\nProgram Tab Configuration The Program tab is where the new PowerShell installation approach shines! Setting Installer type to PowerShell script and selecting the Install_7Zip_2501.ps1 script enables full control over the installation process.\nNote: As can be seen I\u0026rsquo;m not using the Install command type anymore with the classic \u0026quot;\n%SystemRoot%\\sysnative\\WindowsPowerShell\\v1.0\\powershell.exe -executionpolicy bypass -command .\\Install_7Zip_2501.ps1\u0026quot; instead I\u0026rsquo;m taking advantage of the new PowerShell script install type, by directly using my separate stand alone PS script:\nImportant settings: Enforce script signature check: No allows unsigned scripts (acceptable for internal/testing environments) and Run script as 32-bit process: No ensures 64-bit PowerShell execution.\nThe uninstall command uses the MSI product GUID with /x switch for clean removal. Notice the return codes section - 0 and 1707 indicate success, while 3010 and 1641 handle reboot scenarios.\nRequirements Configuration The Requirements tab defines where the app can install, I\u0026rsquo;m specifically choosing only \u0026ldquo;Install on x64 system\u0026rdquo; with a Minimum operating system of \u0026ldquo;Windows 11 v24H2\u0026rdquo;.\nFor a lightweight utility like 7-Zip, leaving disk space and memory requirements blank is fine, the MSI installer handles prerequisite checks internally but more complex applications may require custom requirement scripts:\nDetection Rules Detection rules tell Intune how to verify successful installation. Using File detection with path C:\\Program Files\\7-zip and file 7z.exe is reliable for 7-Zip. The String (version) method with operator Greater than or equal to and value 25.01.00.0 ensures the detection passes only when the correct version is installed.\nThis version-based detection is superior to simple file existence checks, it prevents false positives from older installations and enables proper upgrade detection for future versions.\nFinal step is to assign the application to a group, in this case I specifically add it as an \u0026ldquo;Available\u0026rdquo; type, since I want to manually install it from the \u0026ldquo;Company Portal\u0026rdquo;:\nAfter finishing creating the application and reviewing it once again, you\u0026rsquo;ll notice something interesting, the Install command shows a - (dash) and the Install script shows: Install_7Zip_2501.ps1 but if you edit the app again it will show the correct Installer type: PowerShell script .\nI believe this behavior confirms the script is metadata not being part of the command line.\nCompany Portal Verification Open the Company Portal select the app from the list and Install it.\nThe end-user view in Company Portal confirms successful deployment. As expected the app appears with my custom logo, naming convention and all the other information. The blue checkmark with Installed status indicates the detection rule passed successfully.\nDevice Install Status The App Overview dashboard provides a consolidated view of deployment health, the donut charts show Device status and User status with 1 Installed perfect success rate for my initial deployment:\nThe Device install status view in Intune provides per-device deployment tracking, the status shows Installed for my test device, with the detected app version 25.01.00.0 matching the detection rule configuration:\nInstallation Troubleshooting The Intune Management Extension log folder at: C:\\ProgramData\\Microsoft\\IntuneManagementExtension\\Logs\nis the primary location for advanced Intune app troubleshooting.\nThis folder contains all IME-related logs, in my case the file 7-Zip-25.01-x64-install.log is a custom transcript created by the PowerShell script using Start-Transcript.\nFor advanced application troubleshooting, two logs are especially important:\nAppWorkload.log which shows how Intune processes the app deployment. The custom install log 7-Zip-25.01-x64-install.log which captures exactly what the installation script executed and returned. Understanding and correlating these logs is essential when diagnosing Win32 app deployment issues in Intune.\n7-Zip-25.01-x64-install.log Reviewing 7-Zip-25.01-x64-install.log will reveal the following two entries:\nHost Application: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NoProfile -ExecutionPolicy Bypass -File C:\\Windows\\IMECache\\6e0911dd-6755-4eb7-8a75-ba02e685232b_1\\ea57d2d6-fb24-45a9-a0d0-638eb33b93f4.ps1\nAlthough the script is named Install_7Zip_2501.ps1 in Intune because the Intune Management Extension executes it under a GUID-based name:\n[Win32App] lpExitCode 0\nWhich is the final confirmation that the installation completed successfully, an exit code of 0 means the installer returned success and Intune accepted the result. Combined with the custom transcript log this is the definitive confirmation that the Win32 app deployment ran as expected.\nImportant: The IME renames the script internally, this is why searching the logs for the keyword Install_7Zip_2501.ps1 returns nothing, since the IME only tracks the GUID-based filename.\nAppWorkload.log The following entries from AppWorkload.log show the complete execution flow for my Win32 app using a PowerShell script installer:\n1. Policy Received Intune confirms that a Win32 app assignment was received for the user and session, this is the moment the device becomes aware that work needs to be done:\n[Win32App] Got 1 Win32App(s) for user e297c863-88ff-465c-a24c-8c124a3b35d3 in session 1\n2. App Details \u0026amp; Script Reference Intune loads the full app definition: detection rules, install and uninstall commands, requirements, return codes and the associated PowerShell script.\nAt this stage you can already see the script referenced by its internal GUID and not by the friendly name shown in the Intune portal:\nGet policies = [{\u0026ldquo;Id\u0026rdquo;:\u0026ldquo;6e0911dd-6755-4eb7-8a75-ba02e685232b\u0026rdquo;,\u0026ldquo;Name\u0026rdquo;:\u0026ldquo;GBL-WIN11-7z2501-x64\u0026rdquo;,\u0026ldquo;Version\u0026rdquo;:1,\u0026ldquo;Intent\u0026rdquo;:1,\u0026ldquo;TargetType\u0026rdquo;:1,\u0026ldquo;AppApplicabilityStateDueToAssginmentFilters\u0026rdquo;:null,\u0026ldquo;AssignmentFilterIds\u0026rdquo;:null,\u0026ldquo;DetectionRule\u0026rdquo;:\u0026quot;[{\u0026quot;DetectionType\u0026quot;:2,\u0026quot;DetectionText\u0026quot;:\u0026quot;{\\\u0026quot;Path\\\u0026quot;:\\\u0026quot;C:\\\\\\\\Program Files\\\\\\\\7-zip\\\u0026quot;,\\\u0026quot;FileOrFolderName\\\u0026quot;:\\\u0026quot;7z.exe\\\u0026quot;,\\\u0026quot;Check32BitOn64System\\\u0026quot;:false,\\\u0026quot;DetectionType\\\u0026quot;:4,\\\u0026quot;Operator\\\u0026quot;:5,\\\u0026quot;DetectionValue\\\u0026quot;:\\\u0026quot;25.01.00.0\\\u0026quot;}\u0026quot;}]\u0026quot;,\u0026ldquo;InstallCommandLine\u0026rdquo;:\u0026ldquo;msiexec /i \u0026quot;7z2501-x64.msi\u0026quot; /qn\u0026rdquo;,\u0026ldquo;UninstallCommandLine\u0026rdquo;:\u0026ldquo;msiexec /x \u0026quot;{23170F69-40C1-2702-2501-000001000000}\u0026quot; /qn\u0026rdquo;,\u0026ldquo;RequirementRules\u0026rdquo;:\u0026quot;{\u0026quot;RequiredOSArchitecture\u0026quot;:32,\u0026quot;MinimumFreeDiskSpaceInMB\u0026quot;:null,\u0026quot;MinimumWindows10BuildNumer\u0026quot;:\u0026quot;10.0.26100\u0026quot;,\u0026quot;MinimumMemoryInMB\u0026quot;:null,\u0026quot;MinimumNumberOfProcessors\u0026quot;:null,\u0026quot;MinimumCpuSpeed\u0026quot;:null,\u0026quot;RunAs32Bit\u0026quot;:false}\u0026quot;,\u0026ldquo;ExtendedRequirementRules\u0026rdquo;:\u0026quot;[]\u0026quot;,\u0026ldquo;InstallEx\u0026rdquo;:\u0026quot;{\u0026quot;RunAs\u0026quot;:1,\u0026quot;RequiresLogon\u0026quot;:true,\u0026quot;InstallProgramVisibility\u0026quot;:3,\u0026quot;MaxRetries\u0026quot;:3,\u0026quot;RetryIntervalInMinutes\u0026quot;:5,\u0026quot;MaxRunTimeInMinutes\u0026quot;:60,\u0026quot;DeviceRestartBehavior\u0026quot;:1}\u0026quot;,\u0026ldquo;ReturnCodes\u0026rdquo;:\u0026quot;[{\u0026quot;ReturnCode\u0026quot;:0,\u0026quot;Type\u0026quot;:1},{\u0026quot;ReturnCode\u0026quot;:1707,\u0026quot;Type\u0026quot;:1},{\u0026quot;ReturnCode\u0026quot;:3010,\u0026quot;Type\u0026quot;:2},{\u0026quot;ReturnCode\u0026quot;:1641,\u0026quot;Type\u0026quot;:3},{\u0026quot;ReturnCode\u0026quot;:1618,\u0026quot;Type\u0026quot;:4}]\u0026quot;,\u0026ldquo;AvailableAppEnforcement\u0026rdquo;:1,\u0026ldquo;SetUpFilePath\u0026rdquo;:\u0026ldquo;7z2501-x64.msi\u0026rdquo;,\u0026ldquo;ToastState\u0026rdquo;:0,\u0026ldquo;Targeted\u0026rdquo;:1,\u0026ldquo;FlatDependencies\u0026rdquo;:null,\u0026ldquo;MetadataVersion\u0026rdquo;:4,\u0026ldquo;RelationVersion\u0026rdquo;:0,\u0026ldquo;RebootEx\u0026rdquo;:{\u0026ldquo;GracePeriod\u0026rdquo;:-1,\u0026ldquo;Countdown\u0026rdquo;:-1,\u0026ldquo;Snooze\u0026rdquo;:-1},\u0026ldquo;InstallBehavior\u0026rdquo;:0,\u0026ldquo;StartDeadlineEx\u0026rdquo;:{\u0026ldquo;TimeFormat\u0026rdquo;:\u0026quot;\u0026quot;,\u0026ldquo;StartTime\u0026rdquo;:\u0026quot;/Date(-62135596800000)/\u0026quot;,\u0026ldquo;Deadline\u0026rdquo;:\u0026quot;/Date(-62135596800000)/\u0026quot;},\u0026ldquo;RemoveUserData\u0026rdquo;:false,\u0026ldquo;DOPriority\u0026rdquo;:1,\u0026ldquo;newFlatDependencies\u0026rdquo;:true,\u0026ldquo;AssignmentFilterIdToEvalStateMap\u0026rdquo;:null,\u0026ldquo;ContentCacheDuration\u0026rdquo;:null,\u0026ldquo;ESPConfiguration\u0026rdquo;:null,\u0026ldquo;ReevaluationInterval\u0026rdquo;:480,\u0026ldquo;SupportState\u0026rdquo;:null,\u0026ldquo;InstallContext\u0026rdquo;:1,\u0026ldquo;InstallerData\u0026rdquo;:null,\u0026ldquo;AvailableAppRequestType\u0026rdquo;:0,\u0026ldquo;ContentMode\u0026rdquo;:1,\u0026ldquo;Scripts\u0026rdquo;:\u0026quot;[{\u0026quot;Id\u0026quot;:\u0026quot;ea57d2d6-fb24-45a9-a0d0-638eb33b93f4\u0026quot;,\u0026quot;Type\u0026quot;:1,\u0026quot;Data\u0026quot;:null,\u0026quot;EnforceSignatureCheck\u0026quot;:false}]\u0026quot;}]\n3. Status: Installing The device reports back its enforcement status error code of 0 which indicates a clean execution path with no failures reported by the installer:\n[StatusService] Returning status to user with id: e297c863-88ff-465c-a24c-8c124a3b35d3 for V3-managed app with id: 6e0911dd-6755-4eb7-8a75-ba02e685232b and install context: System. Applicability: Applicable, Status: Installed, ErrorCode: 0\n4. Script Downloaded The Intune Management Extension downloads the PowerShell script from Microsoft’s CDN. This confirms the script is treated as separate content, not embedded inside the app payload:\n[Win32App] ExternalCDN mode, content raw URL is https://swdsw02-mscdn.manage.microsoft.com/85ae9e0a-4b2b-4097-918d-3108be0d0efd/1ed98657-e1ec-4e51-a6f4-d2aa6f2b8ef6/ea57d2d6-fb24-45a9-a0d0-638eb33b93f4.ps1.gz.bin\n5. Script Decrypted \u0026amp; Extracted The downloaded script is decrypted and written to the IME cache under a GUID-based filename, this is the file that will actually be executed:\n[Win32App] Decompressed: to C:\\Windows\\IMECache\\6e0911dd-6755-4eb7-8a75-ba02e685232b_1/ea57d2d6-fb24-45a9-a0d0-638eb33b93f4.ps1\n6. Script Executed Finally, the IME launches PowerShell and executes the script from the cache location using a controlled command line with execution policy bypassed:\n[Win32App] Installer script command line: \u0026ldquo;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\u0026rdquo; -NoProfile -ExecutionPolicy Bypass -File \u0026ldquo;C:\\Windows\\IMECache\\6e0911dd-6755-4eb7-8a75-ba02e685232b_1\\ea57d2d6-fb24-45a9-a0d0-638eb33b93f4.ps1\u0026rdquo;\nFinal Validation via Registry State As a last troubleshooting step you can validate the app state directly from the registry too.\nIntune stores per-user and per-app enforcement results under the Intune Management Extension hive:\nComputer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\IntuneManagementExtension\\Win32Apps\\e297c863-88ff-465c-a24c-8c124a3b35d3\\6e0911dd-6755-4eb7-8a75-ba02e685232b_1\\ComplianceStateMessage\nThe ComplianceStateMessage value contains a JSON object that summarizes how Intune evaluated the deployment:\nComplianceStateMessage: {\u0026ldquo;Applicability\u0026rdquo;:0,\u0026ldquo;ComplianceState\u0026rdquo;:1,\u0026ldquo;DesiredState\u0026rdquo;:2,\u0026ldquo;ErrorCode\u0026rdquo;:null,\u0026ldquo;TargetingMethod\u0026rdquo;:0,\u0026ldquo;InstallContext\u0026rdquo;:2,\u0026ldquo;TargetType\u0026rdquo;:1,\u0026ldquo;ProductVersion\u0026rdquo;:null,\u0026ldquo;AssignmentFilterIds\u0026rdquo;:null}\nIn my case:\nApplicability 0 means the app was applicable to the device. ComplianceState 1 means the app is compliant. DesiredState 2 means the app is expected to be present. ErrorCode being null confirms no errors were reported. This combination confirms a successful required deployment that is installed and compliant.\nUnderstanding the State Values App deployment Type (Intent): Values Description 1 Available 3 Required 4 Uninstall Compliance State: Values Description 0 Unknown 1 Compliant 2 Not compliant 3 Conflict (Not applicable for app deployment) 4 Error Desired State: Values Description 0 None 1 NotPresent 2 Present 3 Unknown 4 Available ","date":"2026-01-15","permalink":"https://halfoncloud.com/posts/powershell-script-for-intune-win32-apps/","tags":["MSIntune","PowerShell","Win32"],"title":"PowerShell script installer for Win32 apps Guide"},{"categories":["Cloud"],"contents":"Background and Intent Declarative Device Management (DDM) represents a fundamental architectural shift in how Microsoft Intune manages devices. This article brings those pieces together, it combines verified information with hands-on testing performed on a Windows 11 25H2 virtual machine, along with practical PowerShell checks you can use to validate DDM behavior on real devices.\nThe focus is on Windows (MMP-C / WinDC), while also highlighting where the Windows implementation differs from other platforms.\nShort Summary If you only need the essentials:\nTraditional management (OMA-DM)\nIntune continuously pushes settings to the device on a schedule, the device applies them, waits and receives the same instructions again at the next sync.\nDeclarative management (DDM)\nIntune declares the desired end state once, the device understands that state, monitors itself and corrects any drift automatically.\nWhat you need to do\nNothing, the transition is handled by Microsoft and is transparent to administrators.\nUnderstanding the Current State: OMA-DM Before understanding DDM, we need to understand what it replaces.\nWhat is OMA-DM? OMA-DM (Open Mobile Alliance Device Management) is a protocol originally designed for mobile phones that Microsoft adopted for Windows 10/11 management. It uses SyncML (XML-based) for communication between the Intune service (DM Server) and the device (DM Client).\nThe OMA-DM Command Set Command Function Get Retrieve value from a node in the Management Tree Add Create new node or configuration Replace Modify existing value Delete Remove node or configuration Exec Execute predefined function on device Copy Replicate subtree structure OMA-DM Workflow Model Server queries state, sends commands and verifies result, this loop repeats constantly for every policy. The traditional model follows a repetitive cycle every 8 hours.\nProblems with OMA-DM Chatty network traffic, every policy requires full GET-SET-GET cycle Slow policy application, hundreds of policies = hundreds of cycles Settings can drift between check-ins No offline enforcement capability If one step fails the chain breaks How DDM Changes This DDM (Declarative Device Management) works on a fundamentally different model:\nThe Declarative Model Instead of repeatedly telling the device what to do, DDM tells the device once what it should look like, the device then maintains that state autonomously.\nAspect OMA-DM DDM/MMP-C Protocol Type Imperative, transactional Declarative, state-based Communication Model Push-Pull Pull-only Communication Medium SyncML (XML) MOF document Trigger Server-initiated (WNS) or 8h client 4h client-initiated State Awareness Stateless State-aware, maintains desired state Remediation Manual (new command needed) Automatic (self-healing) Offline Enforcement No Yes Self-Healing: The Killer Feature With DDM, if a user or malware changes a setting, WinDC service detects drift (within seconds), auto-corrects from local cached desired state, works even when device is offline and no cloud check-in required.\nWindows DDM Architecture Key Components MMP-C (Microsoft Management Platform - Cloud) A new management plane designed for speed, reliability, and scale. It adds a parallel channel optimized for declarative workloads alongside traditional OMA-DM.\nWinDC (Windows Declared Configuration) The Windows service that receives, processes and enforces declarative configurations.\nService Name: dcsvc (Declared Configuration Service)\nWinDC Client Stack Components Component Role WinDC Agent Entry point for MMP-C payloads, pulls desired state and parses MOF documents PolicyManager Central orchestrator evaluates current vs desired state and determines changes CSPs Apply settings when invoked by PolicyManager State Repository Stores current + desired state locally enables drift detection Reporting Engine Sends compliance/status data back to Intune Dual Enrollment Architecture Windows 11 devices maintain two parallel enrollments:\nEnrollment Type ProviderID Channel Purpose Type 6 MS DM Server OMA-DM Legacy policies, broad CSP coverage Type 26 Microsoft Device Management MMP-C/WinDC Declarative workloads Note: This dual enrollment is automatic for all Intune-enrolled Windows devices.\nVerifying DDM on Windows Devices The following commands have been tested and verified on a Windows 11 Enterprise 25H2 (Build 26200.7462):\n1. MDM Services Check the three key services involved in MDM/DDM:\nGet-Service -Name \u0026#34;dmwappushservice\u0026#34;, \u0026#34;DmEnrollmentSvc\u0026#34;, \u0026#34;dcsvc\u0026#34; -ErrorAction SilentlyContinue | Select-Object Name, DisplayName, Status, StartType | Format-Table -AutoSize Another quick health check is to look at the core services used by MDM and Declared Configuration.\nThere are three services that matter:\ndmwappushservice should be running and set to Automatic, it handles push notifications that trigger device syncs. DmEnrollmentSvc is only used during enrollment, on an already enrolled device it is normally Stopped and set to Manual. dcsvc is the Declared Configuration service, it runs only when DDM work is needed, so Stopped with Manual start is expected most of the time. Note: Seeing the last two services stopped does not indicate a problem, this is normal behavior on a healthy enrolled device.\n2. Enrollment Information View all enrollments with provider information:\nGet-ItemProperty \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Enrollments\\*\u0026#34; -ErrorAction SilentlyContinue | Where-Object { $_.ProviderID } | Select-Object PSChildName, ProviderID, EnrollmentType, UPN | Format-Table -AutoSize Key Enrollment Types to Look For:\nEnrollmentType ProviderID Purpose 6 MS DM Server Traditional Intune MDM (OMA-DM) 26 Microsoft Device Management DDM enrollment (MMP-C) 12 WMI_Bridge_SCCM_Server SCCM co-management (if present) 30 Deploy Authority Autopilot/provisioning 31 Cloud Authority Azure AD/cloud trust 28 Local Authority Local device authority You can also confirm DDM support by reviewing the device’s enrollment records. This shows how the device is managed and which management channels are active.\nOn a properly enrolled Intune device you should see multiple enrollment entries, the important ones are:\nEnrollment type 6 represents classic Intune MDM using OMA-DM. Enrollment type 26 represents modern DDM enrollment used by Declared Configuration. Seeing both entries together is expected and indicates that the device supports both management models. Other enrollment types may appear depending on Autopilot, co-management or local authority and their presence is normal.\nNote: If type 26 is missing, Declared Configuration is not active on that device even if other MDM components appear healthy.\n3. DeclaredConfiguration CSP Registration Verify the DDM CSP is registered:\nGet-ChildItem \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\Provisioning\\CSPs\u0026#34; -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.Name -like \u0026#34;*DeclaredConfiguration*\u0026#34; } | Get-ItemProperty | Select-Object PSPath, csp_version DeclaredConfiguration is a modern MDM CSP that isn’t always visible in the registry. Even if HKLM:\\SOFTWARE\\Microsoft\\Provisioning\\CSPs shows nothing, the CSP can still be fully supported and functional.\nThe paths like .\\Device\\Vendor\\MSFT\\DeclaredConfiguration and .\\User\\Vendor\\MSFT\\DeclaredConfiguration are logical CSP URIs, not guaranteed registry keys. On newer Windows builds many CSPs are exposed dynamically by the MDM engine and never written to disk.\nNote: Registry presence is not a reliable way to validate DeclaredConfiguration support, the only real proof is successful policy processing on a supported Windows build.\n4. DDM Scheduled Tasks Check the DDM scheduled tasks and their run history:\nGet-ScheduledTask | Where-Object { $_.TaskName -like \u0026#34;*Declared*\u0026#34; } | ForEach-Object { $task = $_ $info = $_ | Get-ScheduledTaskInfo [PSCustomObject]@{ TaskName = $task.TaskName State = $task.State LastRunTime = $info.LastRunTime NextRunTime = $info.NextRunTime LastResult = \u0026#39;0x{0:X}\u0026#39; -f $info.LastTaskResult } } | Format-Table -AutoSize You can also validate DeclaredConfiguration by checking its scheduled tasks and their run history. These tasks are created by the DDM engine and are responsible for enforcing and re-applying settings over time.\nNormally you should see two tasks, both tasks should exist and be in a Ready state:\nA refresh task that periodically checks for configuration drift and re-applies settings. A watchdog task that enforces configuration less frequently and ensures long-term compliance. When reviewing run results:\n0x0 means the task ran successfully. 0x8000FFFF usually means the DDM engine is present but not actively receiving policies yet, which is common before any DeclaredConfiguration payload is assigned. What DDM Currently Handles As of January 2026 DDM is used for some specific workloads:\nFeature Delivery Method Endpoint Privilege Management (EPM) DDM/MMP-C Advanced Device Inventory DDM/MMP-C MDA Attach V2 DDM/MMP-C Most configuration policies OMA-DM (migrating gradually) Win32 apps IME (unchanged) Scripts IME (unchanged) What DDM (MMP-C) Currently Handles\nEndpoint Privilege Management (EPM) is delivered through the modern channel (MMP-C/WinDC), not traditional OMA-DM SyncML delivery. EPM uses the declarative pipeline for policy enforcement. Advanced Device Inventory (Properties Catalog) leverages MMP-C with richer telemetry delivered via the declarative document model. MDA Attach V2 (Device Management Attach) does not have broad authoritative documentation explicitly tying it to “only DDM”. There is no clear Microsoft doc stating MDA Attach V2 only runs over MMP-C at this time. Most configuration policies today are still delivered via OMA-DM and Policy CSPs, Microsoft is gradually expanding declarative management coverage. Win32 app deployment and PowerShell script execution (IME) remain outside DDM/MMP-C, they use the Intune Management Extension. Note: Microsoft is gradually migrating more policy types to DDM, the transition is automatic and transparent to administrators.\nChannel Distribution on Windows Current approximate distribution of Intune management channels:\nChannel Percentage Examples OMA-DM ~80% Most configuration policies, compliance Intune Management Extension (IME) ~15% Win32 apps, PowerShell scripts, remediations DDM (MMP-C/WinDC) ~5% EPM, Device Inventory Important: These are not official telemetry figures from Microsoft, the precise percentage split (~80/15/5) is not documented by Microsoft and should be presented as an informed industry estimate rather than a firm metric! General reality:\nOMA-DM remains dominant for most traditional configuration policies in production today. MMP-C/Declared Configuration is progressively rolling out and handling an increasing set of workloads (starting with EPM and advanced inventory). IME continues to be the delivery path for Win32 apps and script-based tasks. ","date":"2026-01-14","permalink":"https://halfoncloud.com/posts/microsoft-intune-declarative-device-management-ddm/","tags":["MSIntune","DDM","MMP-C","WinDC"],"title":"Microsoft Intune Declarative Device Management (DDM) Guide"},{"categories":["Cloud"],"contents":"Why Naming Conventions Matter Before diving into \u0026ldquo;Conditional Access\u0026rdquo; policies and Intune configurations, I need to quickly explain the naming convention I use throughout my tenant. This might seem boring but getting this right early saves you a lot of trouble later.\nIf you’re new to Intune chances are your first policies will probably look similar to these ones:\nBitlocker Policy Win10 - Security Settings GBL - W10 - Something - PRD test policy delete later Yes they might get the job done quick but they lack to communicate purpose, scope or lifecycle, adding more only increases your technical debt.\nAfter some research I\u0026rsquo;ve adopted a structured naming convention that scales from 10 to 10000 devices, so here is how it looks in my tenant\nNote: Feel free to use this as a baseline and adjust the logic to align with your own tenant requirements \u0026amp; unique infrastructure needs!\nPosition Field Options Purpose 1 Join Type A = Azure AD, H = Hybrid Determines Autopilot profile 3-4 Country/Site RO, BE, DE, FR, US, etc. Location-specific policies 6 User Type U = User, A = Admin Determines local admin rights 8 Ring D = Dev, C = Canary, P = Production Update/deployment ring 10 Device Type L = Laptop, D = Desktop, S = Shared, K = Kiosk Device category Examples A-RO-U-P-L = Azure AD, Romania, User, Production, Laptop A-RO-A-C-D = Azure AD, Romania, Admin, Canary, Desktop H-RO-U-P-L = Hybrid, Romania, User, Production, Laptop A-RO-U-D-L = Azure AD, Romania, User, Development, Laptop Naming Convention Overview Core Principles Consistency: Same pattern across all object types Scalability: Works for 10 or 10,000 devices Clarity: Immediate understanding without clicking No spaces: Use hyphens for readability Abbreviations: Standardized and documented Key Prefixes Prefix Meaning Usage GBL Global Tenant-wide policies (all countries/sites) RO Romania Country-specific policies BE Belgium Country-specific policies DE Germany Country-specific policies GRP Group All Entra ID groups Platform Codes Code Platform WIN11 Windows 11 (and Windows 10) iOS iOS/iPadOS AND Android macOS macOS Ring Codes Code Ring Purpose (DEV) Development IT testing, Windows Insider, early adopters (CAN) Canary Pilot users, one per department (PRD) Production All other users, stable releases (ALL) All Rings Applies to everyone regardless of ring I\u0026rsquo;ve named my applications to follow this pattern, instead of using generic names like \u0026ldquo;Company Portal\u0026rdquo; or \u0026ldquo;Microsoft Teams\u0026rdquo;, each app now clearly identifies its scope and platform:\nGroups Groups follow a simpler pattern: GRP-[Type]-[Purpose]\nNotice the mix of Dynamic and Assigned membership types, Dynamic groups automatically populate based on device attributes, no manual management required.\nThe GRP-Devices-Development-Hardware and GRP-Devices-Development-VM groups separate physical test machines from virtual machines which is useful when certain policies behave differently, for example in VMware or Hyper-V environments:\nDynamic Group Rules Here\u0026rsquo;s where GroupTags become powerful, each Autopilot device gets a GroupTag during enrollment that encodes its characteristics.\nThe rule (device.devicePhysicalIds -any (_ -contains \u0026quot;[OrderId]:A-RO-U-P-\u0026quot;)) automatically captures all devices with a GroupTag starting with A-RO-U-P- (Azure AD joined, Romania, User, Production).\nGroupTag structure: [JoinType]-[Country]-[UserType]-[Ring]-[DeviceType]: this eliminates manual group assignments entirely, devices land in the correct groups automatically based on how they were enrolled:\nIntune naming convention value This is where the naming convention really proves its value.\nThe naming convention for my Compliance policy makes it obvious that this targets Windows 11 devices in production:\nAs for my Configuration profiles, with 24 policies, imagine trying to find the right one without consistent naming, so now I can immediately identify:\nWhat each policy configures (BitLocker, Defender, EdgeUpdates) Which ring it targets (DEV, CAN, PRD, ALL) The policy type (Settings catalog, ADMX, Endpoint security) I\u0026rsquo;ll cover these policies in detail in future articles, but for now this demonstrates how the naming convention scales:\nWhat\u0026rsquo;s Next With naming conventions established, the next article covers in detail the \u0026ldquo;Conditional Access\u0026rdquo; policies and the actual security controls protecting the tenant.\n","date":"2025-01-11","permalink":"https://halfoncloud.com/posts/m365-business-premium-part-4-intune-naming-conventions-and-standards/","tags":["MSIntune","M365","EntraID"],"title":"M365 Business Premium Part 4: Naming Conventions and Standards"},{"categories":["Cloud"],"contents":"Security Before Enrollment Users should have MFA configured before they enroll devices, Conditional Access policies need to be in place before onboarding begins too.\nGet this right and you have minor interruptions during onboarding, get it wrong and you\u0026rsquo;ll be fielding angry phone calls. This matches what I experienced in the past, having CA policies and authentication methods configured before Autopilot enrollment made the process smooth.\nThe Real Threat Landscape Microsoft blocks an average of ~7,000 password attacks per second, Cyberattacks strike at an unprecedented scale, with Microsoft recording approximately ~600 million blocked threat attempts every 24 hours. This volume represents an increase in hostile actions, creating a threat environment where malicious packets slam into networks nearly every second.\nSource: \u0026ldquo;Microsoft Digital Defense Report 2025\u0026rdquo; https://www.microsoft.com/en-us/corporate-responsibility/dmc/en-us/corporate-responsibility/cybersecurity/microsoft-digital-defense-report-2025/\n80-90% of successful ransomware compromises originate through unmanaged devices. This is exactly why device compliance and Conditional Access matter, blocking unmanaged devices cuts off a major attack vector.\nThe good news: most successful cyberattacks could be stopped with basic security hygiene.\nThe 99% Rule Basic security hygiene still protects against 99% of attacks. The five fundamentals are:\nEnable MFA Apply Zero Trust principles Use XDR and antimalware Keep systems up to date Protect data What Are You Protecting? Focus on what matters to the organization: sensitive information, device security, encryption and malware protection.\nFew years ago I stumble across this quote worth remembering: \u0026ldquo;Try not to make it a dictatorship\u0026rdquo;!\nSecurity that\u0026rsquo;s too restrictive gets bypassed, the goal is protection without killing productivity.\nEntra Admin Center Overview The Entra admin center gives you a quick snapshot of your tenant. Here you can see my tenant HalfOnCloud with the primary domain devworkplace.cloud and a Entra ID P1 licensing.\nTenant Properties The Properties tab shows the tenant configuration, data is stored in EU Model Clause compliant datacenters, which matters for GDPR.\nNote: Security Defaults is blocked because Conditional Access policies are already in use in my tenant, so that\u0026rsquo;s an expected behavior.\nIdentity Secure Score The Recommendations tab shows the Identity Secure Score at the moment 50.76% which refreshes every ~24 hours.\nProbably you\u0026rsquo;ll see a couple of recommendations broken down by priority, the high-priority items include MFA for admins, blocking legacy authentication and ensuring all users can complete MFA:\nIdentity Secure Score - Status View This expanded view shows which recommendations are completed and when.\nSeveral items show \u0026ldquo;Completed\u0026rdquo; status: consent controls, multiple global admins, password expiration settings and least privileged roles.\nIdentity Secure Score - P2 Requirements Scrolling down reveals items that require higher licensing. \u0026ldquo;Protect all users with a sign-in risk policy\u0026rdquo; and \u0026ldquo;Protect all users with a user risk policy\u0026rdquo; both need Entra ID P2, same with Defender for Identity deployment.\nNote: These will be address in the future with the addition of the E5 Security add-on activation.\nNamed Locations Named locations help reduce false positives in security reports and enable location-based Conditional Access policies.\nIn my tenant I\u0026rsquo;ve configured RO-Home-HalfOnCloud as a trusted IP ranges location using my own IP public address, which in this example it\u0026rsquo;s linked to one of my existing Conditional Access policies \u0026ldquo;CA-003-Require-MFA-All-Users\u0026rdquo;:\nNamed Location Details Opening the location shows the configuration, the name follows my naming convention (Country-Context-Tenant).\nNote: The \u0026ldquo;Naming Convention\u0026rdquo; section will be addressed in a future article.\n\u0026ldquo;Mark as trusted location\u0026rdquo; is enabled with my home IP range configured, only mark locations as trusted if you genuinely control that network:\nAuthentication Methods The Authentication methods Policies blade shows all available methods:\nIn my tenant, at least for the time being, only Microsoft Authenticator, SMS, Temporary Access Pass, Software OATH tokens, Voice call and Email OTP are enabled for all users.\nPasskey (FIDO2), Hardware OATH tokens, Certificate-based authentication and QR code are disabled.\nNote: In a hardened environment, you\u0026rsquo;d disable SMS and Voice call since they\u0026rsquo;re phishable methods, exploit human psychology through deception (social engineering) via email, phone (vishing), SMS (smishing) or fake websites.\nMicrosoft Authenticator - Enable and Target The Microsoft Authenticator settings show Enable and Target configuration.\nIt\u0026rsquo;s enabled for All users with Optional registration, authentication mode is set to \u0026ldquo;Any\u0026rdquo; which allows both push notifications and passwordless sign-in:\nMicrosoft Authenticator - Configure The Configure tab has the important security features.\n\u0026ldquo;Require number matching for push notifications\u0026rdquo; is Enabled, this prevents MFA fatigue attacks by requiring users to type a number shown on screen.\n\u0026ldquo;Show application name\u0026rdquo; and \u0026ldquo;Show geographic location\u0026rdquo; in notifications help users identify suspicious sign-in attempts:\nTemporary Access Pass Temporary Access Pass (TAP) is enabled for All users with Optional registration.\nTAP is a time-limited passcode for bootstrapping new accounts or account recovery. It\u0026rsquo;s essential for Autopilot scenarios where users need to complete Windows Hello setup before they have any other MFA method registered.\nNote: Only administrators can issue TAP codes.\nTemporary Access Pass - Configure The Configure tab shows the TAP settings I\u0026rsquo;m using. Minimum lifetime is 1 hour, maximum is 23 hours, and default is 8 hours.\nThe important setting here is \u0026ldquo;One-time\u0026rdquo; set to No. One-time TAP codes break Intune enrollment because the code expires after first use and Autopilot needs multiple authentications during setup:\nTemporary Access Pass - Edit Settings This is how the edit panel for TAP configuration looks, you can set lifetime in Minutes, Hours or Days.\nI\u0026rsquo;ve configured 1 hour minimum, 23 hours maximum and 8 hours default, Length is 8 characters. \u0026ldquo;Require one-time use\u0026rdquo; is set to No for the Autopilot compatibility reason mentioned above:\nPassword Protection Password protection helps prevent weak and predictable passwords, Smart lockout is configured with 10 failed attempts before lockout and 60 seconds lockout duration.\nI\u0026rsquo;ve enabled a custom banned password list with organization-specific terms, for example: halfoncloud, devworkplace, intune, bucharest, romania, Password, Welcome etc.. These are words attackers would likely try first.\nNote: Password protection for Windows Server Active Directory is disabled since this is a cloud-only environment.\nAuthentication Strengths Authentication strengths let you define which MFA methods are acceptable for different scenarios. You can use built-in strengths or create custom ones.\nI have one custom strength called \u0026ldquo;SecInfo-Registration-Secure\u0026rdquo;, plus the three built-in options: Multifactor authentication, Passwordless MFA and Phishing-resistant MFA.:\nCustom Authentication Strength This shows my custom \u0026ldquo;SecInfo-Registration-Secure\u0026rdquo; authentication strength. It solves the chicken-and-egg problem where users need MFA to register their MFA methods.\nThe allowed methods are Windows Hello for Business, Passkeys (FIDO2), Certificate-based Authentication, and Temporary Access Pass (both one-time and multi-use). This lets new users authenticate with a TAP code to set up their permanent MFA method.\nNote: The Phishing-resistant custom MFA is linked to a Microsoft-managed policy, which will be addressed in another article.\nPassword Reset - Properties Self-service password reset is enabled for All users.\nThe blue banner is important: \u0026ldquo;Admins are always enabled for SSPR and require two authentication methods to reset their password\u0026rdquo;.\nThis page links to Authentication methods, Registration, Notifications and other SSPR settings:\nPassword Reset - Authentication Methods Users need 1 method to reset their password, also Security questions are available as an option.\nFor my tenant I\u0026rsquo;ve configured 5 questions required to register and 4 questions required to reset. The banner reminds us that admins always need 2 methods regardless of this setting:\nPassword Reset - Registration Users are required to register when signing in, this ensures everyone has SSPR methods configured before they actually need them.\nRe-confirmation is set to 180 days, so users verify their authentication info every 6 months.\nPassword Reset - Notifications Both notification options are enabled. Users get notified when their password is reset and all admins get notified when any admin resets their password.\nThe admin notification is a security feature, it helps detect if someone has compromised an admin account and is resetting passwords:\nPassword Reset - Administrator Policy This read-only page shows the administrator-specific SSPR policy. Admins always have SSPR enabled and always require 2 methods to reset.\nAvailable methods for admins include Email, Mobile phone (SMS), Mobile phone (voice), Office phone, Mobile app code and Mobile app notification.\nNote: Security questions are not available for admins as they\u0026rsquo;re weak authentication, admins typically use stronger methods.\nUser Settings User settings control what regular users can do in the tenant, hence I\u0026rsquo;ve disabled several self-service options.\nUsers cannot register applications or create security groups, Non-admin users are restricted from creating tenants, Guest user access is set to the most restrictive option, Access to the Entra admin center is restricted and LinkedIn account connections are disabled:\nExternal Collaboration Settings This page controls guest user behavior. Guest user access restrictions are set to the most restrictive option, guests can only see their own directory objects.\nFor guest invites, only users with specific admin roles can invite guests. Self-service sign up via user flows is disabled, External users can remove themselves from the organization. Collaboration restrictions allow invitations to any domain for now:\nGroups - General Settings Group settings control self-service group management, Owners can manage group membership requests in My Groups.\nUsers cannot create security groups or Microsoft 365 groups via Azure portals, API, or PowerShell.\nNote: This prevents shadow IT and keeps group management centralized with admins.\nEnterprise Applications The Enterprise applications blade shows applications using your tenant as an identity provider, currently in my tenant there\u0026rsquo;s only one: \u0026ldquo;Microsoft Graph Command Line Tools\u0026rdquo;\nNote: This was created on November 26, 2025 when I\u0026rsquo;ve first connected with the Microsoft Graph PowerShell module. As you add more integrations and consent to apps, they\u0026rsquo;ll appear here.\nUser Consent Settings User consent for applications is set to \u0026ldquo;Do not allow user consent\u0026rdquo;, this means an administrator must approve all apps that request access to organizational data.\nNote: This is more restrictive than the recommended \u0026ldquo;Allow user consent for apps from verified publishers\u0026rdquo; but prevents users from accidentally granting permissions to malicious apps:\nAdmin Consent Settings The admin consent workflow is enabled. When users try to access an app they can\u0026rsquo;t consent to, they can request admin approval.\nOne user is configured as a reviewer, Email notifications and expiration reminders are enabled.\nNote: Consent requests expire after 30 days if not acted upon.\nAdmin Consent Request Reviewers This shows the reviewer selection for admin consent requests, here I\u0026rsquo;ve selected my own user as the reviewer.\nNote: Only users with Global Administrator, Application Administrator or Cloud Application Administrator roles can actually grant admin consent. Other reviewers can review, block or deny requests:\nAdmin Consent Requests Queue This is where pending consent requests appear, currently there are no pending requests.\nWhen users request access to apps they can\u0026rsquo;t consent to themselves, the requests show up here. Reviewers can approve (grant consent), block (disable the app) or deny (ignore the request) from this queue:\nWhat\u0026rsquo;s Next In the next part, I\u0026rsquo;ll cover Conditional Access policies in detail, the actual policies I\u0026rsquo;ve implemented, how they work together and the lessons learned from testing them.\nI\u0026rsquo;ll also walk through the Microsoft Intune prerequisites you need before enrolling your first device.\n","date":"2025-01-10","permalink":"https://halfoncloud.com/posts/m365-business-premium-part-3-entraid-security-best-practices/","tags":["MSIntune","M365","EntraID","Security"],"title":"M365 Business Premium Part 3: Entra ID Security Best Practices"},{"categories":["Cloud"],"contents":"First Look at the Tenant After completing the purchase and the initial MFA setup, you land in the Microsoft 365 admin center. First thing I did here was to check my Admin account under Users \u0026gt; Active users.\nEverything looks correct: Global Administrator role assigned, MFA configured, and the default HalfOnCloud.onmicrosoft.com domain attached to my account.\nOrganization Settings Next stop is Settings \u0026gt; Org settings. This is where you configure tenant-wide options.\nThere are three tabs here: Services, Security \u0026amp; privacy and Organization profile.\nI started with Organization profile to set the basics.\nOrganization Information Under Organization information, you set your technical contact. This is the email address that receives service notifications from Microsoft.\nImportant to set this to someone who actually monitors emails!\nThe sold-to address is pulled from your billing info, so that\u0026rsquo;s already filled in from the purchase (I had to remove mine due to security concerns)\nRelease Preferences This one matters if you want early access to new features. Microsoft offers three options:\nStandard release - Features roll out when Microsoft considers them ready for everyone Targeted release for everyone - Your whole tenant gets features early Targeted release for select users - Only specific users get early features I went with targeted release for select users and added my admin account. This way I can test new features before they hit the rest of the organization. In a production environment, you\u0026rsquo;d add your IT team here.\nData Location Worth checking where Microsoft stores your data. Since I\u0026rsquo;m in Europe, my tenant data sits in European Union/EFTA datacenters for Exchange, Teams \u0026amp; SharePoint.\nNote the \u0026ldquo;Advanced Data Residency\u0026rdquo; section is a paid add-on for stricter data residency controls.\nNot available in all regions and not necessary for most small businesses!\nSecurity and Privacy Settings Switching to the Security \u0026amp; privacy tab.\nThis is where you find password policies, session timeouts, and other security-related tenant settings.\nPassword Expiration Policy Microsoft now recommends setting passwords to never expire which might sound counterintuitive, but the reasoning is solid: forced password changes lead to users picking weaker passwords or just incrementing a number at the end.\nCombined with MFA (which I\u0026rsquo;ve already set up), non-expiring passwords are actually more secure than the old \u0026ldquo;change every 90 days\u0026rdquo; approach.\nIdle Session Timeout I enabled idle session timeout and set it to 12 hours which signs off users out of Microsoft 365 web apps after a period of inactivity.\nThe balance here is security versus convenience, 12 hours means users won\u0026rsquo;t get logged out during a normal workday, but an unattended machine overnight will require re-authentication.\nAdjust this based on your environment, high-security environments might want 1-4 hours, but for a small business 12 hours is reasonable.\nSelf-Service Password Reset SSPR lets users reset their own passwords without calling IT.\nThis is configured in the Entra ID portal, the link takes you directly there.\nNote: I\u0026rsquo;ll cover SSPR setup in a later post when we configure Entra ID settings.\nDomains A quick look at the Domains section, right now I only have the default HalfOnCloud.onmicrosoft.com domain, which Microsoft creates automatically.\nIn a real deployment, you\u0026rsquo;d add your company\u0026rsquo;s custom domain here, this involves adding DNS records to verify ownership.\nAdding a Custom Domain Time to add a real domain, for my tenant I\u0026rsquo;ve acquired a separate new domain called \u0026ldquo;devworkplace.cloud\u0026rdquo;\nUsing the default onmicrosoft.com address works too but it looks unprofessional for an email so I\u0026rsquo;m adding devworkplace.cloud as my custom domain.\nAdd a custom domain you already own and enter your domain name (without www or http)\nDomain Verification Options Microsoft needs to verify you actually own this domain, the recommended method is adding a TXT record to your DNS.\nThere are other options if your registrar doesn\u0026rsquo;t support TXT records, but TXT is the cleanest approach.\nThe TXT Record Details Microsoft gives you the exact values to add. In my case:\nTXT name: @ (or leave blank depending on your registrar) TXT value: MS=ms83647650 TTL: 3600 Copy these values exactly and please note that the MS= code is unique to your tenant!\nAdding the TXT Record at Your Host Provider Now switch to your domain registrar, find the DNS zone editor and add a new TXT record with the values Microsoft provided above.\nSelect your custom domain and Edit the DNS zone:\nHere\u0026rsquo;s what it looks like in domain registrar DNS management:\nType is TXT, name is @, value is the MS= string from Microsoft and TTL is 3600\nDomain Verified - Connection Options Once Microsoft verifies the TXT record, you move to the connection phase. This is where you decide how to set up DNS for Microsoft services.\nI chose \u0026ldquo;Add your own DNS records\u0026rdquo; because I want full control over my DNS configuration.\nThe other option lets Microsoft manage everything, but that means pointing your nameservers to Microsoft which I don\u0026rsquo;t want for a domain that also hosts a website.\nRequired DNS Records for Exchange Here\u0026rsquo;s where it gets detailed, Microsoft lists all the DNS records needed for email to work properly.\nFor Exchange Online, you need the following three records:\nMX record: Routes incoming email to Microsoft CNAME record: autodiscover for email client configuration TXT record: SPF record to prevent email spoofing Adding the MX Record Back in the domain registrar, add an MX record pointing to Microsoft\u0026rsquo;s mail servers.\nThe value is devworkplace-cloud.mail.protection.outlook.com with priority 0 and TTL 3600:\nAdding the Autodiscover CNAME The autodiscover CNAME helps email clients like Outlook automatically find the correct server settings. Name is \u0026ldquo;autodiscover\u0026rdquo;, target is \u0026ldquo;autodiscover.outlook.com\u0026rdquo; and TTL 3600:\nAdding the SPF Record SPF tells receiving mail servers that Microsoft is authorized to send email on behalf of your domain.\nThis is critical for email deliverability, without it your emails might land in spam folders!\nThe value is: \u0026ldquo;v=spf1 include:spf.protection.outlook.com -all\u0026rdquo; and TTL 3600:\nAdvanced Options - Intune and DKIM If you\u0026rsquo;re planning to use Intune for device management (which we are), check \u0026ldquo;Intune and Mobile Device Management for Microsoft 365\u0026rdquo;.\nThis adds two more CNAME records.\nI\u0026rsquo;ve also enabled DKIM (DomainKeys Identified Mail) which adds email signing for better deliverability and security.\nDKIM requires two additional CNAME records.\nIntune CNAME Records For Intune device enrollment to work with your custom domain, add these two CNAME records:\nenterpriseregistration → enterpriseregistration.windows.net enterpriseenrollment → enterpriseenrollment-s.manage.microsoft.com These allow devices to automatically discover your Intune tenant during enrollment.\nDKIM CNAME Records DKIM records are longer and look messy, but they\u0026rsquo;re important. You need two selector records that point to Microsoft\u0026rsquo;s DKIM signing infrastructure.\nThe names are:\nselector1-devworkplace-cloud._domainkey.HalfOnCloud.n-v1.dkim.mail.microsoft\nselector2-devworkplace-cloud._domainkey.HalfOnCloud.n-v1.dkim.mail.microsoft\nNote: The values are unique to your tenant!\nDomain Setup Complete After adding all the DNS records and giving them time to propagate (usually a few minutes, sometimes up to an hour), Microsoft verifies everything and marks the domain as complete.\nFinal Domain Configuration Back in the Domains list, you now see your custom domain alongside the original onmicrosoft.com domain.\nI\u0026rsquo;ve set devworkplace.cloud as the default, which means new users will automatically get email addresses @devworkplace.cloud instead of @HalfOnCloud.onmicrosoft.com.\nBoth domains show as Healthy, which means all DNS records are correctly configured!\nWith the custom domain configured, the tenant is now properly set up for professional use.\nUsers can have email addresses like RaduBogdan@devworkplace.cloud instead of the long onmicrosoft.com addresses.\n","date":"2025-01-09","permalink":"https://halfoncloud.com/posts/m365-business-premium-part-2-configuring-new-tenant/","tags":["MSIntune","M365","Licensing"],"title":"M365 Business Premium Part 2: Configuring the new tenant"},{"categories":["Cloud"],"contents":"Choosing the Right Plan Microsoft offers three main business tiers: Basic, Standard, and Premium. For this blog and my testing environment, I went with \u0026ldquo;Business Premium\u0026rdquo; because it\u0026rsquo;s the only one that includes Intune and Entra ID P1. If you need device management and Conditional Access, the other two won\u0026rsquo;t cut it.\nThe pricing shows $22/user/month for annual billing. I started with monthly to test things out first.\nReal World Pricing in Europe Microsoft publishes prices in USD, but if you\u0026rsquo;re in Europe you pay in local currency plus VAT, the difference is significant.\nI\u0026rsquo;m based in Romania, so here\u0026rsquo;s what the actual costs look like in my region:\nBusiness Premium runs about 29 EUR per user per month with VAT included. That\u0026rsquo;s what I pay for this blog\u0026rsquo;s test tenant. It aligns with typical EU pricing where VAT gets added on top of the base rate.\nE3 is listed at €37.70 per user per month before VAT on Microsoft\u0026rsquo;s Romanian pricing page. Once VAT is applied, you\u0026rsquo;re looking at roughly 45 to 50 EUR per month per user. That\u0026rsquo;s about 1.5 times what Business Premium costs.\nE5 is listed at €59.70 per user per month before VAT. With VAT included, expect around 70 to 75 EUR per user per month. That\u0026rsquo;s roughly 2.5 times the Business Premium price.\nFrom a pure cost perspective: Business Premium at around 29 EUR is competitive and practical for small teams. E3 at 45 to 50 EUR is a meaningful jump that only makes sense if you genuinely need the enterprise management and recovery features. E5 at 70 to 75 EUR is a significant investment that\u0026rsquo;s typically only practical when advanced security automation or compliance tools become necessary.\nA note about \u0026ldquo;Microsoft Teams\u0026rdquo; in the EU: Microsoft previously sold Enterprise plans (E3/E5) without Teams in the EEA due to competition regulations. As of November 2025, customers worldwide can again purchase suites with Teams included. Business plans like Business Premium were not affected and have always included Teams. If you\u0026rsquo;re buying Enterprise plans without Teams, expect to pay about €8 less per user, with Teams available as a separate standalone.\nhttps://www.microsoft.com/en-us/microsoft-365/blog/2025/09/12/evolving-our-productivity-offerings-to-resolve-european-competition-concerns-about-teams/\nStarting the Purchase After clicking \u0026ldquo;Buy now\u0026rdquo; on Business Premium, you land on the subscription setup page. Here you pick how many users, subscription length, and billing frequency.\nI chose 1 user and monthly billing. Yes, monthly costs more per month, but I wanted flexibility while setting everything up. You can always switch to annual later once you\u0026rsquo;re committed.\nCreating Your Admin Account This is where you create your first Global Administrator account. The username you pick here will be your primary admin login, and the domain defaults to yourcompany.onmicrosoft.com.\nIn my case: RaduBogdan@HalfOnCloud.onmicrosoft.com\nStore these credentials somewhere safe. This is your \u0026ldquo;break glass\u0026rdquo; account for when things go wrong. Password manager, secure notes, whatever you use. Just don\u0026rsquo;t lose it.\nPayment Details Standard payment form. Credit card, billing address, the usual. Microsoft accepts Visa, Mastercard, and Amex.\nNote that it says \u0026ldquo;You won\u0026rsquo;t be charged until you buy something\u0026rdquo; which confused me at first. They mean the trial period if you selected one, otherwise you get charged immediately after completing the order.\nOrder Review Final confirmation before purchase. Check the price, quantity, payment method, and billing address. The total here showed €29.91 including tax for monthly billing in my region.\nThe fine print mentions you can cancel within 7 days for a prorated refund. After that, no refunds. Also worth noting: Global, Billing, and Reader admin roles will automatically get access to the billing account.\nOrder Confirmed Done. Order is placed and Microsoft immediately asks you to set up MFA. This is not optional anymore, Microsoft enforces it for all new admin accounts.\nThe \u0026ldquo;Action required\u0026rdquo; box tells you to set up Microsoft Authenticator. You can use other authenticator apps, but Microsoft pushes their own.\nSetting Up MFA Microsoft walks you through the Authenticator setup. Download the app if you don\u0026rsquo;t have it, then follow the prompts.\nThe process is straightforward: open the app, add a work account, scan the QR code (not shown here), and approve the test notification.\nMFA Complete Once the authenticator is linked, you\u0026rsquo;re done with the initial security setup. This becomes your default sign-in method going forward.\nWhat\u0026rsquo;s Next At this point you have an active M365 Business Premium subscription and a secured admin account. The next steps would be accessing the admin center, adding a custom domain, and starting to configure the tenant.\nI\u0026rsquo;ll cover those in the next post.\n","date":"2025-01-08","permalink":"https://halfoncloud.com/posts/m365-business-premium-purchase-part-1/","tags":["MSIntune","M365","Licensing"],"title":"M365 Business Premium Part 1: Purchase and Tenant Setup"},{"categories":["Cloud"],"contents":"The Question Everyone Asks When you start looking at Microsoft 365 subscriptions, the licensing matrix feels designed to confuse you. Business Premium, E3, E5, add-ons, standalone plans. Microsoft doesn\u0026rsquo;t make this easy, does it?\nFor a small business with 10 to 20 users, the question is straightforward: do you actually need E3 or E5, or is Business Premium enough?\nAfter working with these plans and testing them in real environments, I can give you a direct answer. For most small businesses, Business Premium is not just enough. It\u0026rsquo;s the right choice.\nWhat Business Premium Actually Gives You Business Premium is not a stripped-down version of the enterprise plans. It\u0026rsquo;s a complete package built specifically for small and medium businesses, with a cap at 300 users.\nIn a single license you get the full Microsoft 365 productivity suite including Exchange Online, Teams, OneDrive, and SharePoint. You get Intune Plan 1 for device management and app deployment. You get Entra ID Premium P1 which means Conditional Access and proper MFA enforcement. You get Defender for Business for endpoint protection with EDR capabilities. And you get Defender for Office 365 Plan 1 for email security.\nThat\u0026rsquo;s not a starter pack. That\u0026rsquo;s a complete security and management platform. The kind of setup that would have required multiple products and significant budget just a few years ago now comes bundled in one SKU.\nIncludes Office apps, email, Teams, OneDrive, SharePoint, etc. Intune Plan 1 basic device management and compliance policies. Entra ID Premium P1 identity and access control (MFA, Conditional Access). Information Protection \u0026amp; Defender for Business endpoint protection and basic threat defense. Focused on SMB security \u0026amp; management with a ~300 users cap. The Security Question This is where people get nervous. They assume Business Premium must have gaps because it costs less than the enterprise plans.\nHere\u0026rsquo;s the reality: Business Premium protects against the threats that actually hit small businesses. Phishing attempts get blocked by MFA and Conditional Access. Malware and ransomware get caught by Defender for Business. Unmanaged devices get blocked by Intune compliance policies. Unauthorized access gets stopped before it starts.\nThe tools are designed to work without a dedicated security team watching dashboards all day. You just need to configure them properly, set your policies and they do their job.\nWhat matters more than the license tier is whether you actually use what you have. An E5 subscription with default settings is less secure than a properly configured Business Premium tenant. I\u0026rsquo;ve seen it happen.\nAs for subscription comparison, I\u0026rsquo;ve used this great site: https://m365maps.com/matrix.htm#000001000001001000000\nWhere Business Premium Stops Business Premium is optimized for control and baseline security. It doesn\u0026rsquo;t try to be everything.\nYou won\u0026rsquo;t get Intune Plan 2 features like Advanced Analytics or Remote Help. There\u0026rsquo;s no Endpoint Privilege Management for removing local admin rights at scale. No Cloud PKI for certificate automation. No Windows Enterprise features like Autopatch or Quick Machine Recovery. And no Security Copilot for AI-assisted threat hunting.\nThese aren\u0026rsquo;t accidental omissions. They\u0026rsquo;re enterprise features designed for environments with hundreds or thousands of devices, dedicated IT teams, and complex compliance requirements. At 10 to 20 users, you probably don\u0026rsquo;t need them yet.\nHow E3 Changed Recently Microsoft quietly upgraded what E3 includes. It\u0026rsquo;s no longer just Office plus compliance tools.\nE3 now includes Intune Plan 2 with Remote Help and Advanced Analytics. It includes Windows Enterprise E3 with Autopatch readiness and better recovery options. The gap between Business Premium and E3 has widened on the management and recovery side.\nE3 makes sense when device count grows, when recovery time becomes critical, and when you need deeper visibility into what\u0026rsquo;s happening across your fleet. It\u0026rsquo;s the step up when scale starts to matter.\nBut here\u0026rsquo;s what catches people off guard: E3 doesn\u0026rsquo;t automatically include the security features many assume it has. Defender for Business is actually a Business Premium thing. With E3, you often need additional security add-ons to match what Business Premium includes out of the box.\nWhat E3 includes:\nAll Office apps, email, Teams, OneDrive, SharePoint and enterprise storage. Intune Plan 1 (same basic Intune as Business Premium). Entra ID Premium P1 same foundational identity as Business Premium. Enterprise features such as larger mailboxes, Windows Enterprise rights, and broader compliance controls. When E5 Actually Makes Sense E5 is not about getting more features. It\u0026rsquo;s about reducing risk in environments where risk is already high.\nYou move to E5 when you\u0026rsquo;re dealing with privileged access sprawl across your organization. When you need certificate lifecycle management at scale. When your security team needs AI-assisted investigation tools. When compliance and audit requirements demand advanced retention and forensic capabilities.\nIf those problems don\u0026rsquo;t sound familiar, E5 is probably overkill. It\u0026rsquo;s powerful, but most of that power sits unused in small business environments.\nWhat E5 includes:\nAll E3 capabilities plus multiple advanced security and compliance tools. Entra ID Premium P2 (advanced identity protection and governance). More advanced Defender services, Cloud App Security, and tools like Insider Risk Management. Power BI Pro, Teams Phone system, and expanded analytics. The Practical Decision For a small business starting fresh today, Business Premium makes the most sense. It delivers modern identity security, proper device management, and solid endpoint protection without unnecessary complexity. You can actually manage it without hiring dedicated security staff.\nYou should consider moving to E3 when your user count pushes past the 300 limit, when enterprise recovery features become important, or when you need the analytics capabilities that come with Intune Plan 2.\nYou should consider E5 when security operations become a full-time job, when compliance requirements demand advanced tooling, or when you\u0026rsquo;re actively dealing with the kind of threats that need investigation capabilities beyond what standard tools provide.\nUntil you hit those points, Business Premium is not a compromise. In my opinion, it\u0026rsquo;s the optimized choice.\nWhy I Started Here For this blog, I deliberately chose Business Premium as my testing ground. Not because it was cheaper, but because it reflects what most real environments actually run.\nEnterprise features are impressive on paper, but they don\u0026rsquo;t teach you how Microsoft 365 management actually works day to day. Business Premium does. The skills and patterns you build here transfer directly to larger environments later.\nThink of it this way: Business Premium teaches you how modern Microsoft cloud management works. E3 shows you how it scales. E5 shows you how it\u0026rsquo;s defended when things go seriously wrong.\nThis progression matches how most IT careers actually develop. Start with the fundamentals, build real experience, then move up when the problems demand it.\n","date":"2025-01-07","permalink":"https://halfoncloud.com/posts/m365-business-premium-purchase-introduction/","tags":["MSIntune","M365","Licensing","EntraID"],"title":"Microsoft 365 Business Premium vs E3 vs E5"},{"categories":["General"],"contents":"Who I Am I\u0026rsquo;m Radu, an IT professional working mostly with Microsoft technologies. My days are spent somewhere between on-prem infrastructure and cloud services, which is exactly where the name \u0026ldquo;HalfOnCloud\u0026rdquo; comes from. Not fully in the cloud, not stuck in the past but somewhere in between, like most real environments.\nMy main areas are Microsoft SCCM/ConfigMgr, Intune, Azure, Entra ID and Microsoft 365. I also work with VMware for virtualization and PowerShell for pretty much everything else. If it can be automated I\u0026rsquo;ll definetely try to.\nWhat This Blog Is This isn\u0026rsquo;t a polished knowledge base or a collection of perfect tutorials. It\u0026rsquo;s more like my technical journal, a place where I document what I learn, what breaks and what actually works in production.\nYou\u0026rsquo;ll find step-by-step guides based on things I\u0026rsquo;ve actually implemented, PowerShell scripts I use in real environments, troubleshooting notes from problems that took way too long to solve and occasional opinions on tools and approaches that I\u0026rsquo;ve tested myself.\nSome posts will be detailed walkthroughs, others might be short notes so I don\u0026rsquo;t forget how I fixed something. My goal here is practical and reproducible, not theoretical.\nWhy I Started Writing Honestly? Because I kept solving the same problems twice. I\u0026rsquo;d fix something, move on, then six months later face the same issue and have to figure it out again. Writing it down forces me to understand it properly and gives me something to reference later.\nIf other people find it useful, that\u0026rsquo;s a bonus. But this blog exists first for future me, and second for anyone else working with these technologies who might be stuck on the same problems.\nThe Journey I don\u0026rsquo;t have all the answers. I\u0026rsquo;m learning as I go, just like everyone else in IT. Some of what I write today might be outdated or improved tomorrow which is totally fine. This blog is a snapshot of where I am in my technical journey, not a claim to expertise.\nIf you spot something wrong or know a better way, I\u0026rsquo;d genuinely like to hear it. The best solutions usually come from the community, not from one person figuring everything out alone.\nThank you for stopping by.\n","date":"2025-01-07","permalink":"https://halfoncloud.com/posts/welcome-to-halfoncloud/","tags":["About"],"title":"Welcome to HalfOnCloud"},{"categories":null,"contents":"Hi, I\u0026rsquo;m Radu IT professional specializing in Microsoft technologies: SCCM, Intune, Azure, EntraID, and M365. I also work with VMware for virtualization.\nThis blog is where I share tutorials, automation scripts, and insights from my daily work.\n","date":"2025-01-01","permalink":"https://halfoncloud.com/about/","tags":null,"title":"About"}]