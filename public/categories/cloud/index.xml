<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cloud on HalfOnCloud</title>
    <link>https://halfoncloud.com/categories/cloud/</link>
    <description>Recent content in Cloud on HalfOnCloud</description>
    <generator>Hugo</generator>
    <language>en</language>
    <copyright>2026 Radu Bogdan :: HalfOnCloud</copyright>
    <lastBuildDate>Sun, 04 Jan 2026 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://halfoncloud.com/categories/cloud/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Comprehensive CA Policy Audit Script</title>
      <link>https://halfoncloud.com/posts/comprehensive-ca-policy-audit-script/</link>
      <pubDate>Sun, 04 Jan 2026 00:00:00 +0000</pubDate>
      <guid>https://halfoncloud.com/posts/comprehensive-ca-policy-audit-script/</guid>
      <description>&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://halfoncloud.com/images/ca-overview.png&#34; alt=&#34;Conditional Access Overview&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Here&amp;rsquo;s a comprehensive script to audit all your Conditional Access policies.&lt;/p&gt;&#xA;&lt;p&gt;This script connects to Microsoft Graph, retrieves all CA policies, and provides detailed information about each one including user assignments, applications, conditions, and grant controls.&lt;/p&gt;&#xA;&lt;p&gt;It also checks whether your break-glass account is properly excluded from each policy.&lt;/p&gt;&#xA;&lt;h2 id=&#34;the-script&#34;&gt;The Script&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Comprehensive CA Policy Audit Script&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Run this to get full details of all your policies&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Connect-MgGraph&lt;/span&gt; -Scopes &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Policy.Read.All&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;User.Read.All&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;=== CONDITIONAL ACCESS POLICY AUDIT ===&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Date: &lt;/span&gt;$(&lt;span style=&#34;color:#24909d&#34;&gt;Get-Date&lt;/span&gt; -Format &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;yyyy-MM-dd HH:mm&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Gray&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Get break-glass account ID for exclusion check&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUPN&lt;/span&gt; = &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;breakglass@devworkplace.cloud&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUser&lt;/span&gt; = &lt;span style=&#34;color:#24909d&#34;&gt;Get-MgUser&lt;/span&gt; -Filter &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;userPrincipalName eq &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUPN&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;&amp;#34;&lt;/span&gt; -ErrorAction SilentlyContinue&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassId&lt;/span&gt; = &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUser&lt;/span&gt;) { &lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUser&lt;/span&gt;.Id } &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;else&lt;/span&gt; { &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;NOT FOUND&amp;#34;&lt;/span&gt; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Break-Glass Account: &lt;/span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassUPN&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Yellow&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Break-Glass ID: &lt;/span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassId&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Gray&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Get all CA policies&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt; = &lt;span style=&#34;color:#24909d&#34;&gt;Get-MgIdentityConditionalAccessPolicy&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt; &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;========================================&amp;#34;&lt;/span&gt; -ForegroundColor DarkGray&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;POLICY: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.DisplayName)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Green&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;State: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.State)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor &lt;span style=&#34;color:#40ffff&#34;&gt;$&lt;/span&gt;(&lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.State -eq &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;enabled&amp;#34;&lt;/span&gt;) {&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Green&amp;#34;&lt;/span&gt;} &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;else&lt;/span&gt; {&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Yellow&amp;#34;&lt;/span&gt;})&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Created: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.CreatedDateTime)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Modified: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.ModifiedDateTime)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Users&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;--- USERS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Include Users: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeUsers -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Include Groups: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeGroups -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Include Roles: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeRoles -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Exclude Users: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeUsers -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Exclude Groups: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeGroups -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Break-glass exclusion check&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#40ffff&#34;&gt;$bgExcluded&lt;/span&gt; = &lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeUsers -contains &lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassId&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Break-Glass Excluded: &lt;/span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$bgExcluded&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor &lt;span style=&#34;color:#40ffff&#34;&gt;$&lt;/span&gt;(&lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$bgExcluded&lt;/span&gt;) {&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Green&amp;#34;&lt;/span&gt;} &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;else&lt;/span&gt; {&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Red&amp;#34;&lt;/span&gt;})&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Applications&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;--- APPLICATIONS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Include Apps: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Applications.IncludeApplications -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Exclude Apps: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Applications.ExcludeApplications -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Conditions&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;--- CONDITIONS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Platforms: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Platforms.IncludePlatforms -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Locations Include: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Locations.IncludeLocations -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Locations Exclude: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.Locations.ExcludeLocations -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Client Apps: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.ClientAppTypes -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Sign-in Risk: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.SignInRiskLevels -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;User Risk: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.Conditions.UserRiskLevels -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Grant Controls&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;--- GRANT CONTROLS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Operator: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.Operator)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Built-in Controls: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.BuiltInControls -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.AuthenticationStrength) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Authentication Strength: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.AuthenticationStrength.DisplayName)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Magenta&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.TermsOfUse) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Terms of Use: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.GrantControls.TermsOfUse -join &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Session Controls&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;--- SESSION CONTROLS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.SessionControls) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Sign-in Frequency: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.SessionControls.SignInFrequency.Value)&lt;span style=&#34;color:#ed9d13&#34;&gt; &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.SessionControls.SignInFrequency.Type)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Persistent Browser: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policy&lt;/span&gt;.SessionControls.PersistentBrowser.Mode)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;else&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;None configured&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Summary&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;=== SUMMARY ===&amp;#34;&lt;/span&gt; -ForegroundColor Cyan&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Total Policies: &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt;.Count)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Enabled: &lt;/span&gt;$((&lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt; | &lt;span style=&#34;color:#24909d&#34;&gt;Where-Object&lt;/span&gt; {&lt;span style=&#34;color:#40ffff&#34;&gt;$_&lt;/span&gt;.State -eq &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;enabled&amp;#39;&lt;/span&gt;}).Count)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Report-Only: &lt;/span&gt;$((&lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt; | &lt;span style=&#34;color:#24909d&#34;&gt;Where-Object&lt;/span&gt; {&lt;span style=&#34;color:#40ffff&#34;&gt;$_&lt;/span&gt;.State -eq &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;enabledForReportingButNotEnforced&amp;#39;&lt;/span&gt;}).Count)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;Disabled: &lt;/span&gt;$((&lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt; | &lt;span style=&#34;color:#24909d&#34;&gt;Where-Object&lt;/span&gt; {&lt;span style=&#34;color:#40ffff&#34;&gt;$_&lt;/span&gt;.State -eq &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#39;disabled&amp;#39;&lt;/span&gt;}).Count)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#999;font-style:italic&#34;&gt;# Break-glass exclusion summary&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#40ffff&#34;&gt;$missingExclusions&lt;/span&gt; = &lt;span style=&#34;color:#40ffff&#34;&gt;$policies&lt;/span&gt; | &lt;span style=&#34;color:#24909d&#34;&gt;Where-Object&lt;/span&gt; { &lt;span style=&#34;color:#40ffff&#34;&gt;$_&lt;/span&gt;.Conditions.Users.ExcludeUsers -notcontains &lt;span style=&#34;color:#40ffff&#34;&gt;$breakGlassId&lt;/span&gt; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#40ffff&#34;&gt;$missingExclusions&lt;/span&gt;.Count -gt &lt;span style=&#34;color:#3677a9&#34;&gt;0&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;WARNING: Break-glass NOT excluded from:&amp;#34;&lt;/span&gt; -ForegroundColor Red&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#40ffff&#34;&gt;$missingExclusions&lt;/span&gt; | &lt;span style=&#34;color:#24909d&#34;&gt;ForEach-Object&lt;/span&gt; { &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;  - &lt;/span&gt;$(&lt;span style=&#34;color:#40ffff&#34;&gt;$_&lt;/span&gt;.DisplayName)&lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Red }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#6ab825;font-weight:bold&#34;&gt;else&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#24909d&#34;&gt;Write-Host&lt;/span&gt; &lt;span style=&#34;color:#ed9d13&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;`n&lt;/span&gt;&lt;span style=&#34;color:#ed9d13&#34;&gt;Break-glass excluded from all policies&amp;#34;&lt;/span&gt; -ForegroundColor Green&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;&#xA;&lt;p&gt;Before running this script, ensure you have:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
