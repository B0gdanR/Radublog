<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cloud on HalfOnCloud</title><link>https://halfoncloud.com/categories/cloud/</link><description>Recent content in Cloud on HalfOnCloud</description><generator>Hugo</generator><language>en</language><copyright>2026 Radu Bogdan :: HalfOnCloud</copyright><lastBuildDate>Sun, 04 Jan 2026 00:00:00 +0000</lastBuildDate><atom:link href="https://halfoncloud.com/categories/cloud/index.xml" rel="self" type="application/rss+xml"/><item><title>Comprehensive CA Policy Audit Script</title><link>https://halfoncloud.com/posts/comprehensive-ca-policy-audit-script/</link><pubDate>Sun, 04 Jan 2026 00:00:00 +0000</pubDate><guid>https://halfoncloud.com/posts/comprehensive-ca-policy-audit-script/</guid><description>&lt;h2 id="overview"&gt;Overview&lt;/h2&gt;
&lt;p&gt;&lt;img src="https://halfoncloud.com/images/ca-overview.png" alt="Conditional Access Overview"&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s a comprehensive script to audit all your Conditional Access policies.&lt;/p&gt;
&lt;p&gt;This script connects to Microsoft Graph, retrieves all CA policies, and provides detailed information about each one including user assignments, applications, conditions, and grant controls.&lt;/p&gt;
&lt;p&gt;It also checks whether your break-glass account is properly excluded from each policy.&lt;/p&gt;
&lt;h2 id="the-script"&gt;The Script&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Comprehensive CA Policy Audit Script&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Run this to get full details of all your policies&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Connect-MgGraph&lt;/span&gt; -Scopes &lt;span style="color:#ed9d13"&gt;&amp;#34;Policy.Read.All&amp;#34;&lt;/span&gt;, &lt;span style="color:#ed9d13"&gt;&amp;#34;User.Read.All&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;=== CONDITIONAL ACCESS POLICY AUDIT ===&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Date: &lt;/span&gt;$(&lt;span style="color:#24909d"&gt;Get-Date&lt;/span&gt; -Format &lt;span style="color:#ed9d13"&gt;&amp;#39;yyyy-MM-dd HH:mm&amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Gray
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Get break-glass account ID for exclusion check&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassUPN&lt;/span&gt; = &lt;span style="color:#ed9d13"&gt;&amp;#34;breakglass@devworkplace.cloud&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassUser&lt;/span&gt; = &lt;span style="color:#24909d"&gt;Get-MgUser&lt;/span&gt; -Filter &lt;span style="color:#ed9d13"&gt;&amp;#34;userPrincipalName eq &amp;#39;&lt;/span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassUPN&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;&amp;#39;&amp;#34;&lt;/span&gt; -ErrorAction SilentlyContinue
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassId&lt;/span&gt; = &lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$breakGlassUser&lt;/span&gt;) { &lt;span style="color:#40ffff"&gt;$breakGlassUser&lt;/span&gt;.Id } &lt;span style="color:#6ab825;font-weight:bold"&gt;else&lt;/span&gt; { &lt;span style="color:#ed9d13"&gt;&amp;#34;NOT FOUND&amp;#34;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Break-Glass Account: &lt;/span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassUPN&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Yellow
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Break-Glass ID: &lt;/span&gt;&lt;span style="color:#40ffff"&gt;$breakGlassId&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Gray
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Get all CA policies&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt; = &lt;span style="color:#24909d"&gt;Get-MgIdentityConditionalAccessPolicy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6ab825;font-weight:bold"&gt;foreach&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt; &lt;span style="color:#6ab825;font-weight:bold"&gt;in&lt;/span&gt; &lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;========================================&amp;#34;&lt;/span&gt; -ForegroundColor DarkGray
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;POLICY: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.DisplayName)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Green
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;State: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.State)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor &lt;span style="color:#40ffff"&gt;$&lt;/span&gt;(&lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.State -eq &lt;span style="color:#ed9d13"&gt;&amp;#34;enabled&amp;#34;&lt;/span&gt;) {&lt;span style="color:#ed9d13"&gt;&amp;#34;Green&amp;#34;&lt;/span&gt;} &lt;span style="color:#6ab825;font-weight:bold"&gt;else&lt;/span&gt; {&lt;span style="color:#ed9d13"&gt;&amp;#34;Yellow&amp;#34;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Created: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.CreatedDateTime)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Modified: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.ModifiedDateTime)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;--- USERS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Include Users: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeUsers -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Include Groups: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeGroups -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Include Roles: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.IncludeRoles -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Exclude Users: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeUsers -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Exclude Groups: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeGroups -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Break-glass exclusion check&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#40ffff"&gt;$bgExcluded&lt;/span&gt; = &lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Users.ExcludeUsers -contains &lt;span style="color:#40ffff"&gt;$breakGlassId&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Break-Glass Excluded: &lt;/span&gt;&lt;span style="color:#40ffff"&gt;$bgExcluded&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor &lt;span style="color:#40ffff"&gt;$&lt;/span&gt;(&lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$bgExcluded&lt;/span&gt;) {&lt;span style="color:#ed9d13"&gt;&amp;#34;Green&amp;#34;&lt;/span&gt;} &lt;span style="color:#6ab825;font-weight:bold"&gt;else&lt;/span&gt; {&lt;span style="color:#ed9d13"&gt;&amp;#34;Red&amp;#34;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Applications&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;--- APPLICATIONS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Include Apps: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Applications.IncludeApplications -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Exclude Apps: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Applications.ExcludeApplications -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Conditions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;--- CONDITIONS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Platforms: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Platforms.IncludePlatforms -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Locations Include: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Locations.IncludeLocations -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Locations Exclude: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.Locations.ExcludeLocations -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Client Apps: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.ClientAppTypes -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Sign-in Risk: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.SignInRiskLevels -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;User Risk: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.Conditions.UserRiskLevels -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Grant Controls&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;--- GRANT CONTROLS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Operator: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.Operator)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Built-in Controls: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.BuiltInControls -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.AuthenticationStrength) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Authentication Strength: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.AuthenticationStrength.DisplayName)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Magenta
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.TermsOfUse) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Terms of Use: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.GrantControls.TermsOfUse -join &lt;span style="color:#ed9d13"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#999;font-style:italic"&gt;# Session Controls&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;--- SESSION CONTROLS ---&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.SessionControls) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Sign-in Frequency: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.SessionControls.SignInFrequency.Value)&lt;span style="color:#ed9d13"&gt; &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.SessionControls.SignInFrequency.Type)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Persistent Browser: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policy&lt;/span&gt;.SessionControls.PersistentBrowser.Mode)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; } &lt;span style="color:#6ab825;font-weight:bold"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;None configured&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Summary&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;=== SUMMARY ===&amp;#34;&lt;/span&gt; -ForegroundColor Cyan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Total Policies: &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt;.Count)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Enabled: &lt;/span&gt;$((&lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt; | &lt;span style="color:#24909d"&gt;Where-Object&lt;/span&gt; {&lt;span style="color:#40ffff"&gt;$_&lt;/span&gt;.State -eq &lt;span style="color:#ed9d13"&gt;&amp;#39;enabled&amp;#39;&lt;/span&gt;}).Count)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Report-Only: &lt;/span&gt;$((&lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt; | &lt;span style="color:#24909d"&gt;Where-Object&lt;/span&gt; {&lt;span style="color:#40ffff"&gt;$_&lt;/span&gt;.State -eq &lt;span style="color:#ed9d13"&gt;&amp;#39;enabledForReportingButNotEnforced&amp;#39;&lt;/span&gt;}).Count)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;Disabled: &lt;/span&gt;$((&lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt; | &lt;span style="color:#24909d"&gt;Where-Object&lt;/span&gt; {&lt;span style="color:#40ffff"&gt;$_&lt;/span&gt;.State -eq &lt;span style="color:#ed9d13"&gt;&amp;#39;disabled&amp;#39;&lt;/span&gt;}).Count)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#999;font-style:italic"&gt;# Break-glass exclusion summary&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#40ffff"&gt;$missingExclusions&lt;/span&gt; = &lt;span style="color:#40ffff"&gt;$policies&lt;/span&gt; | &lt;span style="color:#24909d"&gt;Where-Object&lt;/span&gt; { &lt;span style="color:#40ffff"&gt;$_&lt;/span&gt;.Conditions.Users.ExcludeUsers -notcontains &lt;span style="color:#40ffff"&gt;$breakGlassId&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6ab825;font-weight:bold"&gt;if&lt;/span&gt; (&lt;span style="color:#40ffff"&gt;$missingExclusions&lt;/span&gt;.Count -gt &lt;span style="color:#3677a9"&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;WARNING: Break-glass NOT excluded from:&amp;#34;&lt;/span&gt; -ForegroundColor Red
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#40ffff"&gt;$missingExclusions&lt;/span&gt; | &lt;span style="color:#24909d"&gt;ForEach-Object&lt;/span&gt; { &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34; - &lt;/span&gt;$(&lt;span style="color:#40ffff"&gt;$_&lt;/span&gt;.DisplayName)&lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt; -ForegroundColor Red }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;} &lt;span style="color:#6ab825;font-weight:bold"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#24909d"&gt;Write-Host&lt;/span&gt; &lt;span style="color:#ed9d13"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;`n&lt;/span&gt;&lt;span style="color:#ed9d13"&gt;Break-glass excluded from all policies&amp;#34;&lt;/span&gt; -ForegroundColor Green
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="prerequisites"&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;Before running this script, ensure you have:&lt;/p&gt;</description></item></channel></rss>